# 采购订单表格模板

**表格名称**: 采购订单管理系统
**创建时间**: [YYYY-MM-DD]
**采购经理**: [Name]

---

## 表格结构

### 主表：采购订单

| 字段名称 | 字段类型 | 必填 | 说明 |
|---------|---------|------|------|
| 采购订单号 | 文本 | ✅ | 唯一标识 |
| 采购物品 | 文本 | ✅ | 物品名称 |
| 采购规格 | 文本 | - | 规格型号 |
| 采购单价 | 数字 | ✅ | 单位：元 |
| 采购数量 | 数字 | ✅ | 采购数量 |
| 采购金额 | 数字 | - | 自动计算：单价×数量 |
| 采购时间 | 日期 | ✅ | 采购日期 |
| 采购人 | 文本 | - | 采购人员 |
| 供应商 | 文本 | - | 供应商名称 |
| 联系方式 | 电话 | - | 供应商联系方式 |
| 订单状态 | 单选 | - | 待审批/已批准/已拒绝/已完成 |
| 预计到货日期 | 日期 | - | 计划到货时间 |
| 实际到货日期 | 日期 | - | 实际到货时间 |
| 备注 | 文本 | - | 其他信息 |

### 关联表：采购明细

| 字段名称 | 字段类型 | 必填 | 说明 |
|---------|---------|------|------|
| 明细编号 | 文本 | ✅ | 唯一标识 |
| 关联订单号 | 关联 | ✅ | 关联到采购订单表 |
| 物品名称 | 文本 | ✅ | 物品名称 |
| 数量 | 数字 | ✅ | 采购数量 |
| 单价 | 数字 | ✅ | 单位：元 |
| 小计 | 数字 | - | 自动计算：数量×单价 |
| 已收货数量 | 数字 | - | 已到货数量 |
| 待收货数量 | 数字 | - | 待收货数量 |

---

## MCP 工具调用示例

### 创建采购订单管理系统

```python
# 1. 创建多维表格
create_bitable(name="采购订单管理系统")

# 2. 获取 table_id
get_tables(app_token)

# 3. 添加采购订单字段
add_table_field(app_token, table_id, "采购订单号", 1)    # 文本
add_table_field(app_token, table_id, "采购物品", 1)      # 文本
add_table_field(app_token, table_id, "采购规格", 1)      # 文本
add_table_field(app_token, table_id, "采购单价", 2)      # 数字
add_table_field(app_token, table_id, "采购数量", 2)      # 数字
add_table_field(app_token, table_id, "采购金额", 2)      # 数字
add_table_field(app_token, table_id, "采购时间", 5)      # 日期
add_table_field(app_token, table_id, "采购人", 1)        # 文本
add_table_field(app_token, table_id, "供应商", 1)        # 文本
add_table_field(app_token, table_id, "联系方式", 11)     # 电话
add_table_field(app_token, table_id, "订单状态", 3)      # 单选
add_table_field(app_token, table_id, "预计到货日期", 5)  # 日期
add_table_field(app_token, table_id, "实际到货日期", 5)  # 日期

# 4. 添加示例数据
add_record(app_token, table_id, {
    "采购订单号": "PO2024001",
    "采购物品": "办公椅",
    "采购规格": "人体工学，可调节",
    "采购单价": 500,
    "采购数量": 10,
    "采购金额": 5000,
    "采购时间": 1704067200000,
    "采购人": "张三",
    "供应商": "优质家具供应商",
    "联系方式": "13800138000",
    "订单状态": "已批准",
    "预计到货日期": 1704867200000,
    "备注": "急需货物，请尽快发货"
})
```

---

## 示例数据

### 采购订单示例

| 采购订单号 | 采购物品 | 采购单价 | 采购数量 | 采购金额 | 采购时间 | 供应商 | 订单状态 |
|-----------|---------|---------|---------|---------|---------|--------|---------|
| PO2024001 | 办公椅 | 500 | 10 | 5000 | 2024-01-15 | 优质家具供应商 | 已批准 |
| PO2024002 | 笔记本电脑 | 5000 | 5 | 25000 | 2024-01-18 | 数码产品供应商 | 待审批 |
| PO2024003 | 打印机 | 1200 | 3 | 3600 | 2024-01-20 | 办公设备供应商 | 已完成 |

### 采购明细示例

| 明细编号 | 关联订单号 | 物品名称 | 数量 | 单价 | 小计 | 已收货数量 | 待收货数量 |
|---------|-----------|---------|------|------|------|-----------|-----------|
| DET001 | PO2024001 | 办公椅 | 10 | 500 | 5000 | 10 | 0 |
| DET002 | PO2024002 | 笔记本电脑 | 5 | 5000 | 25000 | 0 | 5 |
| DET003 | PO2024003 | 打印机 | 3 | 1200 | 3600 | 3 | 0 |

---

## 使用建议

1. **订单编号规则**
   - 建议格式：`PO + 年份 + 序号`
   - 示例：PO2024001, PO2024002

2. **采购金额计算**
   - 采购金额 = 采购单价 × 采购数量
   - 建议在表格中设置自动计算公式

3. **订单状态流转**
   - 待审批 → 已批准 / 已拒绝
   - 已批准 → 已完成（收货后）

4. **收货管理**
   - 收货后更新"实际到货日期"
   - 更新订单状态为"已完成"
   - 记录"已收货数量"

5. **协作权限**
   - 采购人员：edit 权限
   - 采购经理：full_access 权限（审批）
   - 财务人员：view 权限

---

## 常见场景

### 场景 1: 创建采购订单

```
1. 调用 add_record() 创建新订单
2. 生成采购订单号（PO + 年份 + 序号）
3. 填写采购物品、单价、数量
4. 自动计算采购金额
5. 设置订单状态为"待审批"
6. 提交审批
```

### 场景 2: 审批采购订单

```
1. 查询"待审批"状态的订单
2. 审核采购信息和价格
3. 更新订单状态：
   - 同意 → "已批准"
   - 拒绝 → "已拒绝"（填写备注说明原因）
```

### 场景 3: 收货确认

```
1. 查询"已批准"状态的订单
2. 确认收货数量
3. 更新"实际到货日期"
4. 更新订单状态为"已完成"
5. 如有差异，在备注中说明
```

### 场景 4: 供应商管理

```
1. 按供应商统计采购订单
2. 评估供应商表现：
   - 交货及时率
   - 产品质量
   - 价格竞争力
3. 维护供应商信息
```

---

## 字段配置说明

### 单选字段选项

**订单状态**：
- 待审批
- 已批准
- 已拒绝
- 已完成

### 数字字段验证

**采购单价**：
- 最小值：0
- 最大值：无限制
- 单位：元（CNY）

**采购数量**：
- 最小值：1
- 最大值：无限制（建议 < 10000）
- 单位：个/件/套等

**采购金额**：
- 计算公式：采购单价 × 采购数量
- 单位：元（CNY）

---

## 采购管理最佳实践

### 1. 订单审批流程

```
创建订单 → 待审批 → 经理审批 → 已批准 → 供应商发货 → 收货 → 已完成
```

### 2. 金额审批权限

- ≤ 5,000元：采购主管审批
- 5,000-20,000元：采购经理审批
- > 20,000元：部门总监审批

### 3. 供应商评估

定期评估供应商：
- 交货准时率
- 产品质量合格率
- 价格竞争力
- 售后服务

### 4. 成本控制

- 对比多家供应商报价
- 批量采购争取折扣
- 关注库存积压风险

---

## 扩展功能

### 关联表建议

1. **供应商管理表**
   - 供应商名称
   - 联系方式
   - 供应商品类
   - 信用等级
   - 评级记录

2. **采购申请表**
   - 申请部门
   - 申请人
   - 申请物品
   - 申请数量
   - 用途说明
   - 预算金额
   - 审批状态

3. **收货记录表**
   - 关联订单号
   - 收货日期
   - 收货人
   - 收货数量
   - 质量状态
   - 备注

4. **付款记录表**
   - 关联订单号
   - 付款日期
   - 付款金额
   - 付款方式
   - 付款状态

---

## 数据统计建议

### 1. 月度采购统计

- 采购订单数量
- 采购总金额
- 按供应商统计
- 按物品类别统计

### 2. 供应商分析

- 供应商采购频次
- 供应商采购金额占比
- 供应商交货准时率

### 3. 成本分析

- 平均采购单价
- 采购金额趋势
- 预算执行情况
