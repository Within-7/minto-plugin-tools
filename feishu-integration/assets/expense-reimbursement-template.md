# 费用报销表格模板

**表格名称**: 费用报销管理系统
**创建时间**: [YYYY-MM-DD]
**财务负责人**: [Name]

---

## 表格结构

### 主表：报销单

| 字段名称 | 字段类型 | 必填 | 说明 |
|---------|---------|------|------|
| 报销单号 | 文本 | ✅ | 唯一标识 |
| 报销人 | 文本 | ✅ | 报销人员姓名 |
| 部门 | 单选 | ✅ | 技术部/产品部/市场部/销售部/人事部/财务部/运营部 |
| 报销类型 | 单选 | ✅ | 交通/餐饮/住宿/办公/差旅/培训/其他 |
| 报销金额 | 数字 | ✅ | 单位：元 |
| 报销日期 | 日期 | ✅ | 费用发生日期 |
| 费用说明 | 文本 | ✅ | 费用详细说明 |
| 审批人 | 文本 | - | 审批人员姓名 |
| 审批状态 | 单选 | - | 待审批/已批准/已拒绝 |
| 审批时间 | 日期 | - | 审批完成时间 |
| 审批意见 | 文本 | - | 审批备注 |
| 报销状态 | 单选 | - | 待报销/已报销/已打回 |
| 报销时间 | 日期 | - | 财务打款时间 |
| 报销备注 | 文本 | - | 其他信息 |
| 附件 | 附件 | - | 发票、收据等凭证 |

### 关联表：报销明细

| 字段名称 | 字段类型 | 必填 | 说明 |
|---------|---------|------|------|
| 明细编号 | 文本 | ✅ | 唯一标识 |
| 关联报销单号 | 关联 | ✅ | 关联到报销单表 |
| 费用项目 | 文本 | ✅ | 具体费用名称 |
| 费用金额 | 数字 | ✅ | 单位：元 |
| 费用日期 | 日期 | ✅ | 费用发生日期 |
| 费用说明 | 文本 | - | 费用详情 |
| 发票号码 | 文本 | - | 发票号码 |
| 发票类型 | 单选 | - | 增值税专用发票/普通发票/电子发票/收据 |

---

## MCP 工具调用示例

### 创建费用报销管理系统

```python
# 1. 创建多维表格
create_bitable(name="费用报销管理系统")

# 2. 获取 table_id
get_tables(app_token)

# 3. 添加报销单字段
add_table_field(app_token, table_id, "报销单号", 1)       # 文本
add_table_field(app_token, table_id, "报销人", 1)         # 文本
add_table_field(app_token, table_id, "部门", 3)           # 单选
add_table_field(app_token, table_id, "报销类型", 3)       # 单选
add_table_field(app_token, table_id, "报销金额", 2)       # 数字
add_table_field(app_token, table_id, "报销日期", 5)       # 日期
add_table_field(app_token, table_id, "费用说明", 1)       # 文本
add_table_field(app_token, table_id, "审批人", 1)         # 文本
add_table_field(app_token, table_id, "审批状态", 3)       # 单选
add_table_field(app_token, table_id, "审批时间", 5)       # 日期
add_table_field(app_token, table_id, "审批意见", 1)       # 文本
add_table_field(app_token, table_id, "报销状态", 3)       # 单选
add_table_field(app_token, table_id, "报销时间", 5)       # 日期
add_table_field(app_token, table_id, "附件", 7)           # 附件

# 4. 添加示例数据
add_record(app_token, table_id, {
    "报销单号": "BX2024001",
    "报销人": "张三",
    "部门": "技术部",
    "报销类型": "差旅",
    "报销金额": 2500,
    "报销日期": 1704067200000,
    "费用说明": "北京出差高铁票和住宿费",
    "审批人": "李经理",
    "审批状态": "已批准",
    "报销状态": "已报销",
    "报销时间": 1704672000000
})
```

---

## 示例数据

### 报销单示例

| 报销单号 | 报销人 | 部门 | 报销类型 | 报销金额 | 报销日期 | 审批状态 | 报销状态 |
|---------|-------|------|---------|---------|---------|---------|---------|
| BX2024001 | 张三 | 技术部 | 差旅 | 2500 | 2024-01-15 | 已批准 | 已报销 |
| BX2024002 | 李四 | 市场部 | 餐饮 | 800 | 2024-01-18 | 待审批 | 待报销 |
| BX2024003 | 王五 | 销售部 | 交通 | 500 | 2024-01-20 | 已批准 | 已报销 |
| BX2024004 | 赵六 | 产品部 | 办公 | 1200 | 2024-01-22 | 已拒绝 | 已打回 |

### 报销明细示例

| 明细编号 | 关联报销单号 | 费用项目 | 费用金额 | 费用日期 | 发票号码 | 发票类型 |
|---------|-------------|---------|---------|---------|---------|---------|
| DET001 | BX2024001 | 高铁票 | 500 | 2024-01-15 | 12345678 | 电子发票 |
| DET002 | BX2024001 | 住宿费 | 2000 | 2024-01-15 | 87654321 | 增值税专用发票 |
| DET003 | BX2024002 | 团建聚餐 | 800 | 2024-01-18 | 11223344 | 普通发票 |

---

## 使用建议

1. **报销单号规则**
   - 建议格式：`BX + 年份 + 序号`
   - 示例：BX2024001, BX2024002

2. **报销审批流程**
   - 员工提交报销单
   - 部门经理审批（≤ 5000元）
   - 总监审批（5000-20000元）
   - 总经理审批（> 20000元）
   - 财务审核并打款

3. **报销类型限制**
   - **交通**：市内交通、城际交通
   - **餐饮**：工作餐、接待餐、团建聚餐
   - **住宿**：出差住宿
   - **办公**：办公用品、软件订阅
   - **差旅**：出差综合费用
   - **培训**：培训费用、书籍购买

4. **附件要求**
   - 所有报销必须上传发票或收据
   - 发票金额 ≥ 报销金额
   - 电子发票上传 PDF 或图片
   - 纸质发票拍照上传

5. **协作权限**
   - 报销人：edit 权限（仅自己提交的）
   - 部门经理：edit 权限（审批本部门）
   - 财务人员：full_access 权限
   - 其他员工：view 权限

---

## 常见场景

### 场景 1: 提交报销申请

```
1. 调用 add_record() 创建报销单
2. 生成报销单号（BX + 年份 + 序号）
3. 填写报销信息：
   - 报销人
   - 部门
   - 报销类型
   - 报销金额
   - 报销日期
   - 费用说明
4. 上传发票附件
5. 设置审批状态为"待审批"
6. 提交审批
```

### 场景 2: 审批报销

```
1. 查询"待审批"状态的报销单
2. 检查报销金额是否合理
3. 检查发票是否齐全
4. 检查费用说明是否清晰
5. 更新审批状态：
   - 同意 → "已批准"（填写审批意见）
   - 拒绝 → "已拒绝"（填写拒绝原因）
6. 记录审批时间
```

### 场景 3: 财务打款

```
1. 查询"已批准"且"待报销"的单据
2. 核对银行账户信息
3. 安排打款
4. 更新报销状态为"已报销"
5. 记录报销时间
```

### 场景 4: 查询报销记录

```
1. 按报销人查询：个人报销记录
2. 按部门查询：部门报销统计
3. 按类型查询：分类报销统计
4. 按时间查询：月度/季度/年度报销统计
```

---

## 字段配置说明

### 单选字段选项

**部门**：
- 技术部
- 产品部
- 市场部
- 销售部
- 人事部
- 财务部
- 运营部

**报销类型**：
- 交通
- 餐饮
- 住宿
- 办公
- 差旅
- 培训
- 其他

**审批状态**：
- 待审批
- 已批准
- 已拒绝

**报销状态**：
- 待报销
- 已报销
- 已打回

**发票类型**：
- 增值税专用发票
- 普通发票
- 电子发票
- 收据

### 数字字段验证

**报销金额**：
- 最小值：0.01
- 最大值：无限制（建议 < 100000）
- 单位：元（CNY）
- 保留两位小数

---

## 报销管理最佳实践

### 1. 报销审批权限

| 报销金额 | 审批人 |
|---------|-------|
| ≤ 500元 | 部门经理 |
| 500-5000元 | 部门总监 |
| 5000-20000元 | 分管副总 |
| > 20000元 | 总经理 |

### 2. 报销时效要求

- **费用发生后**：7个工作日内提交报销
- **审批时效**：3个工作日内完成审批
- **打款时效**：审批通过后5个工作日内打款

### 3. 发票要求

- 发票抬头：公司全称
- 发票税号：公司税号
- 发票金额：≥ 报销金额
- 发票日期：费用发生前后7天内
- 发票类型：增值税发票优先

### 4. 禁止报销项目

- 个人消费
- 违规罚款
- 礼品馈赠
- 娱乐消费
- 家庭支出

---

## 扩展功能

### 关联表建议

1. **预算管理表**
   - 部门
   - 预算类型
   - 预算金额
   - 已用金额
   - 剩余金额
   - 预算周期

2. **借款记录表**
   - 借款人
   - 借款金额
   - 借款日期
   - 借款用途
   - 还款日期
   - 还款状态

3. **发票管理表**
   - 发票号码
   - 发票类型
   - 发票金额
   - 开票日期
   - 报销状态
   - 附件

---

## 数据统计建议

### 1. 月度报销统计

- 报销单数量
- 报销总金额
- 按部门统计
- 按类型统计
- 平均审批时长

### 2. 部门报销对比

- 各部门报销金额
- 各部门报销频次
- 各部门人均报销

### 3. 报销类型分析

- 各类型报销占比
- 各类型平均金额
- 高频报销类型

### 4. 异常报销预警

- 大额报销（> 10000元）
- 频繁报销（月度 > 10次）
- 超时报销（超过30天）
- 无发票报销
