---
name: "beauty-normal-step4"
description: "Code content audit and inspection. Automatically invoked during step 4 of the beauty-normal command to comprehensively check the generated JSON+HTML presentation, ensure quality and integrity, implement one-vote veto system. 代码内容审核检验。在beauty-normal命令的步骤4执行时自动调用，全面检查生成的JSON+HTML演示文稿，确保质量和完整性，实行一票否决制。"
---

# Beauty-Normal 步骤4：代码内容审核检验 / Beauty-Normal Step 4: Code Content Audit and Inspection

## ⚠️ 最关键步骤！必须严格执行！/ MOST CRITICAL STEP! Must be strictly executed!

## 目标 / Goal

全面检查生成的 JSON+HTML 演示文稿，确保质量和完整性。

Comprehensively check the generated JSON+HTML presentation to ensure quality and integrity.

## ⚠️ 核心原则

**实行一票否决制：**
- **内容完整性检验**：必须100%保留原文所有章节、数据、结论，零遗漏
- **JSON数据检验**：JSON格式必须正确，数据结构必须完整
- **HTML渲染检验**：HTML必须能正确渲染JSON数据
- **代码质量检验**：必须符合HTML最佳实践，可访问可运行
- **资源使用检验**：必须验证步骤2和步骤3是否正确读取并使用了skill资源
- **发现问题立即回退**：返回对应步骤重新执行，绝不将就

**⚠️ Token限制处理原则：**

**🔑 最核心规则（必须严格遵守）：如果数据内容过大，或者token过长，则自动使用'继续'进行'分段'加载数据，绝对不能精简、偷工减料的节省token,严禁为了省token而跳过内容或使用摘要**

**当遇到 token 限制或上下文长度问题时，必须使用"继续"分页方式，绝对禁止：**
- ❌ 压缩或省略资源读取
- ❌ 跳过必读资源
- ❌ 简化执行步骤
- ❌ 减少生成内容
- ❌ 使用摘要代替完整内容
- ❌ 精简数据内容
- ❌ 偷工减料节省token

**正确处理方式：使用"继续"机制**
```
1. 在完成当前可执行的部分后
2. 明确说明："由于 token 限制，任务未完成，请输入'继续'以获取剩余部分"
3. 等待用户输入"继续"后
4. 继续执行剩余步骤
5. 重复直到任务完全完成
```

**分段加载原则：**
- ✅ **完整保留**：每段数据都必须100%保留，无遗漏、无压缩
- ✅ **分段清晰**：明确标注当前是第几段，共几段
- ✅ **连续执行**：每段完成后自动提示"继续"，等待用户确认
- ✅ **质量优先**：宁可多轮对话，不可降低质量
- ❌ **禁止精简**：绝对不能为了省token而精简数据内容
- ❌ **禁止偷工**：绝对不能为了省token而偷工减料

**关键规则：**
- ✅ **质量 > 速度**：宁可多轮对话，不可降低质量
- ✅ **完整 > 简化**：宁可分多次执行，不可压缩内容
- ✅ **标准 > 妥协**：宁可触发继续，不可偷工减料

---

## 📋 执行流程（7个子步骤）

```
步骤4.1：资源使用验证
  ↓
步骤4.2：内容完整性检查
  ↓
步骤4.3：JSON数据格式检查
  ↓
步骤4.4：HTML渲染功能检查
  ↓
步骤4.5：代码质量检查
  ↓
步骤4.6：功能验证
  ↓
步骤4.7：生成最终报告
```

---

## 步骤 4.1：资源使用验证

### 目标

验证步骤2和步骤3是否正确读取并使用了skill资源。

### 步骤2资源使用验证

#### 验证方法1：检查图表选择是否基于chart-selection-guide.md

```
□ 是否读取了 chart-selection-guide.md？
□ 是否识别了内容结构类型（9种类型之一）？
□ 是否根据决策树选择了对应的图表？
□ 是否记录了选择理由（关键词匹配）？

如果否 → 返回步骤2重新执行
```

#### 验证方法2：检查是否参考了图表示例文件

```
□ 是否读取了 CHART_EXAMPLES_INDEX.md？
□ 每个选择的图表是否都有对应的示例文件？
□ 是否从示例文件中复制了代码？
□ 图表类型与内容是否匹配？

如果否 → 返回步骤2重新执行
```

#### 验证方法3：检查是否阅读了观点可视化指南

```
□ 是否读取了 INSIGHT_VISUALIZATION_GUIDE.md？
□ 是否根据观点类型选择了可视化方式？
□ 是否避免了纯文本项目符号列表？

如果否 → 返回步骤2重新执行
```

### 步骤3资源使用验证

#### 验证方法1：检查是否基于最佳实践生成

```
□ 是否读取了 best-practices.md？
□ HTML结构是否符合语义化要求？
□ CSS是否遵循了设计原则？
□ 是否保持了内容完整性（不总结、不篡改）？

如果否 → 返回步骤3重新执行
```

#### 验证方法2：检查是否遵循了McKinsey设计系统

```
□ 是否读取了 mckinsey-design-system.md？
□ 是否使用了定义的配色方案？
□ 字体大小是否符合规范？
□ 间距是否符合标准？

如果否 → 返回步骤3重新执行
```

#### 验证方法3：检查是否使用了模板

```
□ 是否读取了 presentation-template.html？
□ HTML结构是否基于模板？
□ 导航功能是否完整？
□ 是否包含了模板中的所有必要组件？

如果否 → 返回步骤3重新执行
```

#### 验证方法4：检查图表代码来源

```
□ 每个图表的代码是否来自assets/示例文件？
□ 是否完整复制了CSS、HTML、JavaScript？
□ 是否根据实际数据进行了定制？
□ McKinsey配色是否保持一致？

如果否 → 返回步骤3重新执行
```

#### 验证方法5：⚠️ 新增 - 检查是否使用了JSON数据结构规范

```
□ 是否读取了 beauty-json/SKILL.md？
□ JSON数据结构是否符合规范？
□ 是否为每种幻灯片类型选择了正确的JSON结构？
□ JSON数据是否包含所有内容？

如果否 → 返回步骤3重新执行
```

### 资源使用检查清单

```
步骤2 - 幻灯片设计阶段：
□ 已读取：references/chart-selection-guide.md
□ 已读取：assets/CHART_EXAMPLES_INDEX.md
□ 已读取：assets/INSIGHT_VISUALIZATION_GUIDE.md
□ 已制作：图表选择决策表（内容类型 → 关键词 → 推荐图表 → 示例文件）
□ 已记录：每个图表的选择理由
□ 已复制：对应示例文件的代码

步骤3 - JSON数据生成与HTML渲染阶段：
□ 已读取：references/best-practices.md
□ 已读取：references/mckinsey-design-system.md
□ 已读取：references/template-guide.md
□ 已读取：assets/presentation-template.html
□ 已读取：assets/TEMPLATE_USAGE_GUIDE.md
□ 已读取：beauty-json/SKILL.md（⚠️ 新增）
□ 已复制：所有选中图表的示例代码
□ 已应用：McKinsey配色和排版规范
□ 已保持：内容完整性（零篡改、零遗漏）
□ 已设计：JSON数据结构（符合beauty-json/SKILL.md规范）
□ 已生成：JSON数据（包含所有幻灯片内容）
□ 已实现：JavaScript渲染逻辑（能够正确解析和渲染JSON）

❌ 发现任何资源未读取或未使用 → 立即返回对应步骤重新执行
```

### ⚠️ 回退触发条件

```
以下任一情况发生，必须回退：

1. 步骤2未读chart-selection-guide.md
   → 返回步骤2，读取资源后重新选择图表

2. 步骤2选择的图表与chart-selection-guide.md不符
   → 返回步骤2，根据指南重新选择

3. 步骤2未从assets/示例文件复制代码
   → 返回步骤2，读取示例文件后复制代码

4. 步骤3未读best-practices.md
   → 返回步骤3，读取资源后重新生成HTML

5. 步骤3生成的HTML不符合mckinsey-design-system.md规范
   → 返回步骤3，根据规范重新生成

6. 步骤3未基于presentation-template.html
   → 返回步骤3，使用模板重新生成

7. 步骤3未读beauty-json/SKILL.md（⚠️ 新增）
   → 返回步骤3，读取资源后重新设计JSON数据结构

8. 步骤3生成的JSON数据结构不符合beauty-json/SKILL.md规范（⚠️ 新增）
   → 返回步骤3，根据规范重新设计JSON数据结构

9. 步骤3生成的JSON数据不完整（⚠️ 新增）
   → 返回步骤3，补充JSON数据

10. 步骤3的JavaScript无法正确解析JSON（⚠️ 新增）
    → 返回步骤3，修复JavaScript解析逻辑

11. 步骤3的JavaScript无法正确渲染HTML（⚠️ 新增）
    → 返回步骤3，修复JavaScript渲染逻辑
```

### 输出产物

- 资源使用验证报告
- 回退建议（如有）

### 验证标准

- [ ] 所有必读资源都已读取
- [ ] 所有资源都已正确使用
- [ ] 无资源被跳过或省略
- [ ] 符合设计规范
- [ ] JSON数据结构符合beauty-json/SKILL.md规范（⚠️ 新增）

---

## 步骤 4.2：内容完整性检查

### 目标

确保所有原文内容都已正确包含在JSON数据和HTML文件中，无遗漏、无错误。

### ⚠️ 严格检验方法 - 逐章对照原文档

#### 第一步：提取原文档的所有章节结构

```
使用工具提取文档的所有标题
推荐使用 Read 工具完整阅读文档，记录所有标题层级
```

#### 第二步：制作章节对照清单

创建一个对照表，逐项检查：

```markdown
章节对照清单：

原文档章节                    JSON幻灯片页面           HTML渲染页面           状态
─────────────────────────────────────────────────────────────────────────
H1: [主标题]                页面1: 封面页           封面页                ✓
H2: [第一章标题]            页面3: 第一章章节首页     第一章章节首页         ✓
  H3: [子章节1.1]           页面4: 内容页             内容页                ✓
  H3: [子章节1.2]           页面5: 内容页             内容页                ✓
  H3: [子章节1.3]           页面6: 内容页             内容页                ✓
H2: [第二章标题]            页面7: 第二章章节首页     第二章章节首页         ✓
  H3: [子章节2.1]           页面8: 内容页             内容页                ✓
  H3: [子章节2.2]           页面9: 内容页             内容页                ✓
  H3: [子章节2.3]           页面10: 内容页            内容页                ✓
...
```

#### 第三步：逐项验证内容完整性

**验证项目1：章节标题完整性**

```
□ 所有H1标题是否包含在JSON数据中？
□ 所有H2章节是否都有对应的JSON幻灯片页面？
□ 所有H3子章节是否都有对应的JSON幻灯片页面？
□ 章节顺序是否与原文一致？
□ 章节编号是否正确？
□ JSON数据中的幻灯片ID是否连续？
```

**验证项目2：要点内容完整性**

```
□ 所有要点是否都已包含在JSON数据中？
□ 要点文字是否完整（未删减）？
□ 要点顺序是否与原文一致？
□ 子要点是否都已包含？
□ 是否有重复内容？
□ JSON数据中的数组是否包含所有要点？
```

**验证项目3：数据完整性**

```
□ 所有数据点是否都已包含在JSON数据中？
□ 数值是否准确（无错误）？
□ 单位是否正确？
□ 百分比是否正确？
□ 货币符号是否正确？
□ JSON数据中的数值是否与原文一致？
```

**验证项目4：表格完整性**

```
□ 所有表格是否都已包含在JSON数据中？
□ 表格行数是否正确？
□ 表格列数是否正确？
□ 表格数据是否准确？
□ 表格标题是否正确？
□ JSON数据中的表格结构是否完整？
```

**验证项目5：结论完整性**

```
□ 所有结论是否都已包含在JSON数据中？
□ 结论文字是否完整？
□ 结论位置是否合理？
□ 是否有遗漏的结论？
□ JSON数据中的结论字段是否完整？
```

**验证项目6：图表完整性**

```
□ 所有需要的图表是否都已包含在JSON数据中？
□ 图表类型是否合适？
□ 图表数据是否准确？
□ 图表标题是否正确？
□ 图表标签是否清晰？
□ JSON数据中的图表配置是否完整？
```

### ⚠️ 常见问题检查

#### 问题1：内容被压缩或省略

```
错误示例：
原文：平台A估值14-21亿美元，平台B估值150-200万美元，估值差距10-20倍
JSON数据："平台A估值14-21亿美元，平台B估值150-200万美元"（省略了估值差距）

✅ 正确做法：
JSON数据："平台A估值14-21亿美元，平台B估值150-200万美元，估值差距10-20倍"
```

#### 问题2：要点被合并

```
错误示例：
原文：
1. 商业模式分析
2. 用户定位分析
3. 定价策略分析
JSON数据：["商业模式、用户定位、定价策略分析"]（3个要点合并为1个）

✅ 正确做法：
JSON数据：["商业模式分析", "用户定位分析", "定价策略分析"]
```

#### 问题3：数据被简化

```
错误示例：
原文：市场份额从2022年的35%增长到2024年的65%，增长率30个百分点
JSON数据："市场份额增长到65%"（省略了起始数据和增长率）

✅ 正确做法：
JSON数据："市场份额从2022年的35%增长到2024年的65%，增长率30个百分点"
```

#### 问题4：JSON数据结构不完整

```
错误示例：
原文包含：主标题、副标题、作者、日期
JSON数据：只有主标题和副标题（缺少作者和日期）

✅ 正确做法：
JSON数据：包含所有字段（mainTitle, subtitle, meta.date, meta.author）
```

### 输出产物

- 章节对照清单
- 内容完整性验证报告
- 问题清单（如有）

### 验证标准

- [ ] 所有章节都已包含在JSON数据中
- [ ] 所有要点都已包含在JSON数据中
- [ ] 所有数据都已包含在JSON数据中
- [ ] 所有表格都已包含在JSON数据中
- [ ] 所有结论都已包含在JSON数据中
- [ ] 无内容被压缩或省略
- [ ] 无内容被篡改或简化
- [ ] JSON数据结构完整

---

## 步骤 4.3：JSON数据格式检查

### 目标

确保JSON数据格式正确，数据结构完整，符合规范。

### 验证项目

#### 1. JSON格式验证

```
□ JSON格式正确（可通过JSON.parse验证）
□ 无语法错误
□ 无多余逗号
□ 无缺少引号
□ 无缺少括号
□ 无特殊字符错误
```

**验证方法**：

```javascript
// 使用JSON.parse验证JSON格式
try {
    const parsedData = JSON.parse(jsonString);
    console.log('JSON格式正确');
} catch (error) {
    console.error('JSON格式错误:', error.message);
}
```

#### 2. JSON数据结构验证

```
□ 根结构正确（包含presentation字段）
□ presentation字段包含meta和slides字段
□ meta字段包含title、subtitle、author、date字段
□ slides字段是数组类型
□ 每个幻灯片包含id、type、template、title、content字段
□ 所有必需字段都已包含
□ 无多余字段
```

**根结构验证**：

```json
{
  "presentation": {
    "meta": {
      "title": "演示文稿标题",
      "subtitle": "副标题",
      "author": "作者",
      "date": "日期"
    },
    "slides": [...]
  }
}
```

**幻灯片结构验证**：

```json
{
  "id": 1,
  "type": "cover|toc|section|content|end",
  "template": "01-cover-page|02-two-column|...",
  "title": "幻灯片标题",
  "content": {...}
}
```

#### 3. JSON数据类型验证

```
□ id字段是数字类型
□ type字段是字符串类型
□ template字段是字符串类型
□ title字段是字符串类型
□ content字段是对象类型
□ 数组字段是数组类型
□ 数值字段是数字类型
□ 字符串字段是字符串类型
```

#### 4. JSON数据完整性验证

```
□ JSON包含所有幻灯片数据
□ 每个幻灯片包含完整内容
□ 数据结构符合beauty-json/SKILL.md规范
□ 无数据遗漏
□ 无数据错误
□ 所有必需字段都已包含
```

#### 5. 幻灯片类型验证

```
□ 所有幻灯片type字段值有效（cover|toc|section|content|end）
□ type字段与content结构匹配
□ type字段与template字段匹配
□ 封面页type为cover
□ 目录页type为toc
□ 章节首页type为section
□ 内容页type为content
□ 结束页type为end
```

#### 6. 模板类型验证

```
□ 所有幻灯片template字段值有效
□ template字段与type字段匹配
□ template字段值在beauty-html/assets/INDEX.md中存在
□ template字段值与content结构匹配
```

#### 7. 幻灯片ID验证

```
□ 幻灯片ID从1开始
□ 幻灯片ID连续（1, 2, 3, ...）
□ 无重复ID
□ 无缺失ID
□ 幻灯片ID数量与slides数组长度一致
```

#### 8. 图表数据验证

```
□ 包含图表的幻灯片content字段包含chart对象
□ chart对象包含type、title、data、options字段
□ chart.data包含labels和datasets字段
□ chart.datasets是数组类型
□ chart.options包含responsive和maintainAspectRatio字段
□ 图表数据类型正确（数值、字符串等）
□ 图表数据完整（无遗漏）
```

**图表数据结构验证**：

```json
{
  "chart": {
    "type": "bar|line|pie|...",
    "title": "图表标题",
    "data": {
      "labels": [...],
      "datasets": [...]
    },
    "options": {
      "responsive": true,
      "maintainAspectRatio": false
    }
  }
}
```

### ⚠️ 常见JSON错误检查

#### 错误1：JSON语法错误

```
错误示例：
{
  "presentation": {
    "slides": [
      {
        "id": 1,
        "type": "cover",
      }  // 多余逗号
    ]
  }
}

✅ 正确做法：
{
  "presentation": {
    "slides": [
      {
        "id": 1,
        "type": "cover"
      }
    ]
  }
}
```

#### 错误2：缺少引号

```
错误示例：
{
  "presentation": {
    "title": 演示文稿标题  // 缺少引号
  }
}

✅ 正确做法：
{
  "presentation": {
    "title": "演示文稿标题"
  }
}
```

#### 错误3：缺少括号

```
错误示例：
{
  "presentation": {
    "slides": [
      {
        "id": 1
      // 缺少闭合括号
    ]
  }
}

✅ 正确做法：
{
  "presentation": {
    "slides": [
      {
        "id": 1
      }
    ]
  }
}
```

#### 错误4：数据结构不符合规范

```
错误示例：
{
  "presentation": {
    "slides": [
      {
        "id": 1,
        "type": "cover",
        "content": {
          "mainTitle": "标题"
          // 缺少subtitle和meta字段
        }
      }
    ]
  }
}

✅ 正确做法：
{
  "presentation": {
    "slides": [
      {
        "id": 1,
        "type": "cover",
        "content": {
          "mainTitle": "标题",
          "subtitle": "副标题",
          "meta": {
            "date": "日期",
            "author": "作者"
          }
        }
      }
    ]
  }
}
```

### 输出产物

- JSON格式验证报告
- JSON数据结构验证报告
- JSON数据类型验证报告
- JSON数据完整性验证报告
- 错误清单（如有）

### 验证标准

- [ ] JSON格式正确（可通过JSON.parse验证）
- [ ] JSON包含所有幻灯片数据
- [ ] 每个幻灯片包含完整内容
- [ ] 数据结构符合beauty-json/SKILL.md规范
- [ ] 无数据遗漏
- [ ] 无数据错误
- [ ] 无JSON语法错误
- [ ] 幻灯片ID连续且正确
- [ ] 幻灯片类型和模板匹配
- [ ] 图表数据完整且正确

---

## 步骤 4.4：HTML渲染功能检查

### 目标

确保HTML能够正确加载JSON数据，JavaScript能够正确解析和渲染JSON，所有内容正确显示。

### 验证项目

#### 1. JSON数据加载验证

```
□ HTML文件包含JSON数据（在<script>标签中）
□ JSON数据变量名正确（presentationData）
□ JSON数据格式正确
□ JSON数据位置正确（在渲染函数之前）
```

**验证方法**：

```javascript
// 检查JSON数据是否加载
console.log('JSON数据:', presentationData);
console.log('幻灯片数量:', presentationData.presentation.slides.length);
```

#### 2. JSON数据解析验证

```
□ JavaScript能够访问JSON数据
□ JavaScript能够读取presentation字段
□ JavaScript能够读取meta字段
□ JavaScript能够读取slides数组
□ JavaScript能够遍历slides数组
□ JavaScript能够读取每个幻灯片的字段
```

**验证方法**：

```javascript
// 检查JSON数据解析
const meta = presentationData.presentation.meta;
const slides = presentationData.presentation.slides;

console.log('标题:', meta.title);
console.log('幻灯片数量:', slides.length);

slides.forEach((slide, index) => {
    console.log(`幻灯片${index + 1}:`, slide.title, slide.type);
});
```

#### 3. HTML渲染验证

```
□ JavaScript能够正确渲染HTML
□ 渲染函数能够生成正确的HTML字符串
□ HTML字符串包含正确的标签和类名
□ HTML字符串包含正确的内容
□ HTML字符串能够插入到DOM中
□ 所有幻灯片都已渲染
```

**验证方法**：

```javascript
// 检查HTML渲染
const container = document.getElementById('presentation-container');
console.log('容器内容:', container.innerHTML);
console.log('渲染的幻灯片数量:', container.children.length);
```

#### 4. 内容显示验证

```
□ 所有标题正确显示
□ 所有文本正确显示
□ 所有要点正确显示
□ 所有数据正确显示
□ 所有图表正确显示
□ 所有图标正确显示
□ 无内容缺失
□ 无内容错误
```

#### 5. 图表渲染验证

```
□ 所有图表都已渲染
□ 图表Canvas元素已创建
□ 图表Canvas ID正确
□ 图表实例已创建
□ 图表数据正确显示
□ 图表标题正确显示
□ 图表标签正确显示
□ 图表图例正确显示
□ 图表交互功能正常（tooltip等）
```

**验证方法**：

```javascript
// 检查图表渲染
const charts = Chart.instances;
console.log('图表数量:', charts.length);

charts.forEach((chart, index) => {
    console.log(`图表${index + 1}:`, chart.config.type, chart.data);
});
```

#### 6. 响应式设计验证

```
□ 桌面端显示正常（≥1200px）
□ 平板端显示正常（768px-1199px）
□ 手机端显示正常（<768px）
□ 图表在移动端显示正常
□ 文本在移动端可读
□ 布局在移动端正确
```

#### 7. DOM结构验证

```
□ HTML结构正确
□ 所有标签正确闭合
□ 所有类名正确
□ 所有ID正确
□ 无多余的标签
□ 无重复的ID
□ DOM树结构清晰
```

### ⚠️ 常见渲染错误检查

#### 错误1：JSON数据未加载

```
错误现象：
控制台错误：Uncaught ReferenceError: presentationData is not defined

原因：
JSON数据变量名错误或未定义

✅ 正确做法：
确保JSON数据变量名为presentationData，且在渲染函数之前定义
```

#### 错误2：JSON数据解析失败

```
错误现象：
控制台错误：Cannot read property 'presentation' of undefined

原因：
JSON数据结构错误或未正确加载

✅ 正确做法：
确保JSON数据结构正确，包含presentation字段
```

#### 错误3：HTML渲染失败

```
错误现象：
幻灯片未显示，容器为空

原因：
渲染函数错误或未正确调用

✅ 正确做法：
确保渲染函数正确，且在DOMContentLoaded事件中调用
```

#### 错误4：图表渲染失败

```
错误现象：
图表未显示，Canvas为空白

原因：
图表配置错误或数据格式错误

✅ 正确做法：
确保图表配置正确，数据格式符合Chart.js要求
```

#### 错误5：图表宽度为0

```
错误现象：
图表宽度为0，不显示

原因：
未设置responsive: true或maintainAspectRatio: false

✅ 正确做法：
确保图表options包含：
{
  responsive: true,
  maintainAspectRatio: false
}
```

### 输出产物

- JSON数据加载验证报告
- JSON数据解析验证报告
- HTML渲染验证报告
- 内容显示验证报告
- 图表渲染验证报告
- 响应式设计验证报告
- 错误清单（如有）

### 验证标准

- [ ] HTML能够正确加载JSON数据
- [ ] JavaScript能够正确解析JSON
- [ ] JavaScript能够正确渲染所有幻灯片
- [ ] 所有内容正确显示
- [ ] 所有图表正确显示
- [ ] 导航功能正常
- [ ] 响应式设计正常
- [ ] 无渲染错误

---

## 步骤 4.5：代码质量检查

### 目标

确保生成的HTML文件符合最佳实践，代码质量高，可访问可运行。

### 验证项目

#### 1. HTML结构检查

```
□ HTML结构完整且正确
□ DOCTYPE声明正确
□ html、head、body标签完整
□ 所有标签正确闭合
□ 无语法错误
□ 语义化标签使用正确
□ 无多余的标签
□ 无重复的ID
```

#### 2. CSS样式检查

```
□ CSS样式完整且符合规范
□ CSS变量定义完整
□ 所有样式类都已定义
□ 响应式样式完整
□ 无语法错误
□ 无冗余样式
□ 样式命名规范
□ 样式优先级正确
```

#### 3. JavaScript代码检查

```
□ JavaScript代码完整且无错误
□ 所有函数都已定义
□ 所有变量都已声明
□ 无语法错误
□ 无运行时错误
□ 代码逻辑正确
□ 代码可读性好
□ 代码可维护性好
```

#### 4. 可访问性检查

```
□ 语义化HTML标签使用正确
□ 图像alt属性（如有）
□ 颜色对比度符合标准（≥4.5:1）
□ 字体大小可读
□ 键盘导航支持（如有）
□ 屏幕阅读器友好
```

#### 5. 性能优化检查

```
□ 无冗余代码
□ 无重复代码
□ 代码压缩友好
□ 资源加载优化
□ 渲染性能良好
□ 无内存泄漏
```

### 输出产物

- HTML结构验证报告
- CSS样式验证报告
- JavaScript代码验证报告
- 可访问性验证报告
- 性能优化验证报告
- 错误清单（如有）

### 验证标准

- [ ] HTML结构完整且正确
- [ ] CSS样式完整且符合规范
- [ ] JavaScript代码完整且无错误
- [ ] 可访问性符合标准
- [ ] 性能优化合理
- [ ] 无语法错误
- [ ] 无冗余代码

---

## 步骤 4.6：功能验证

### 目标

确保生成的HTML文件所有功能都正常工作。

### 验证项目

#### 1. 基本功能验证

```
□ 基本功能正常
□ HTML文件可以正常运行
□ 无JavaScript错误
□ 无CSS错误
□ 无HTML错误
□ 页面加载正常
```

#### 2. JSON数据功能验证

```
□ JSON数据加载正常
□ JSON数据解析正常
□ JSON数据读取正常
□ JSON数据遍历正常
□ JSON数据访问正常
```

#### 3. HTML渲染功能验证

```
□ HTML渲染正常
□ 所有幻灯片都已渲染
□ 所有内容正确显示
□ 所有样式正确应用
□ 所有类名正确应用
```

#### 4. 图表功能验证

```
□ 图表显示正常
□ 所有图表都已渲染
□ 图表数据正确显示
□ 图表标题正确显示
□ 图表标签正确显示
□ 图表图例正确显示
□ 图表交互功能正常（tooltip等）
□ 图表动画正常
```

#### 5. 导航功能验证

```
□ 导航功能正常
□ 页面滚动正常
□ 页面跳转正常（如有）
□ 返回顶部功能正常（如有）
```

#### 6. 响应式设计验证

```
□ 响应式设计正常
□ 桌面端显示正常（≥1200px）
□ 平板端显示正常（768px-1199px）
□ 手机端显示正常（<768px）
□ 图表在移动端显示正常
□ 文本在移动端可读
□ 布局在移动端正确
```

#### 7. 浏览器兼容性验证

```
□ 浏览器兼容性良好
□ Chrome浏览器正常
□ Firefox浏览器正常
□ Safari浏览器正常
□ Edge浏览器正常
```

### 输出产物

- 基本功能验证报告
- JSON数据功能验证报告
- HTML渲染功能验证报告
- 图表功能验证报告
- 导航功能验证报告
- 响应式设计验证报告
- 浏览器兼容性验证报告
- 错误清单（如有）

### 验证标准

- [ ] 基本功能正常
- [ ] JSON数据加载正常
- [ ] JSON数据解析正常
- [ ] HTML渲染正常
- [ ] 所有功能都正常工作
- [ ] 图表显示正常
- [ ] 导航功能正常
- [ ] 响应式设计正常
- [ ] 浏览器兼容性良好
- [ ] 无功能性问题

---

## 步骤 4.7：生成最终报告

### 目标

汇总所有验证结果，生成最终验收报告。

### 报告结构

```markdown
# Beauty-Normal 步骤4：代码内容审核检验 - 最终报告

## 📊 执行摘要

- 执行时间：[日期时间]
- 总页数：[N页]
- 总代码行数：[约1300行]
- 文件大小：[约70KB]

## ✅ 验证结果总览

### 资源使用验证
- 状态：[通过/不通过]
- 问题数：[N个]
- 严重问题：[N个]

### 内容完整性检查
- 状态：[通过/不通过]
- 问题数：[N个]
- 严重问题：[N个]

### JSON数据格式检查
- 状态：[通过/不通过]
- 问题数：[N个]
- 严重问题：[N个]

### HTML渲染功能检查
- 状态：[通过/不通过]
- 问题数：[N个]
- 严重问题：[N个]

### 代码质量检查
- 状态：[通过/不通过]
- 问题数：[N个]
- 严重问题：[N个]

### 功能验证
- 状态：[通过/不通过]
- 问题数：[N个]
- 严重问题：[N个]

## 📋 详细验证报告

### 1. 资源使用验证报告

[详细内容]

### 2. 内容完整性验证报告

[详细内容]

### 3. JSON数据格式验证报告

[详细内容]

### 4. HTML渲染功能验证报告

[详细内容]

### 5. 代码质量验证报告

[详细内容]

### 6. 功能验证报告

[详细内容]

## 🎨 设计规范验证（一票否决制）

### 颜色规范验证
- [ ] 使用McKinsey标准色板（#FFFFFF, #000000, #F85d42, #74788d, #556EE6, #34c38f, #50a5f1, #f1b44c）
- [ ] 未使用紫色渐变背景
- [ ] 未使用AI生成的色板
- [ ] 未使用非McKinsey颜色组合
- [ ] 主色调为白色背景+黑色标题
- [ ] 强调色使用正确（#F85d42用于关键高亮）
- [ ] 图表颜色使用标准色板
- [ ] 对比度符合可读性标准（≥4.5:1）

### 字体规范验证
- [ ] 使用系统字体（-apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC"等）
- [ ] 未使用Inter、Roboto、Arial等通用字体
- [ ] 标题字体大小符合规范（48-64px）
- [ ] 副标题字体大小符合规范（28-36px）
- [ ] 正文字体大小符合规范（16-20px）
- [ ] 图表标签字体大小符合规范（12-14px）
- [ ] 字体粗细使用正确（标题bold，正文regular）
- [ ] 行高符合规范（1.6-1.8）

### 布局规范验证
- [ ] 未使用圆角卡片（border-radius: 8px等）
- [ ] 未使用通用模板布局
- [ ] 边距符合规范（40-60px）
- [ ] 元素间距符合规范（20-30px）
- [ ] 两列布局间距符合规范（30-40px）
- [ ] 图表容器最小高度符合规范（400px）
- [ ] 所有元素对齐到网格
- [ ] 视觉平衡良好

### 设计风格验证
- [ ] 整体风格符合McKinsey标准
- [ ] 无装饰性图标或图形
- [ ] 无不必要的动画效果
- [ ] 阴影使用最小化（0-2px）
- [ ] 边框使用最小化（仅在需要时使用）
- [ ] 白空间充足（不拥挤）
- [ ] 专业、简洁、无杂乱

## 🎯 最终验收结论

### 总体评分

- 资源使用验证：[A+/A/B/C/D]
- 内容完整性验证：[A+/A/B/C/D]
- JSON数据格式验证：[A+/A/B/C/D]
- HTML渲染功能验证：[A+/A/B/C/D]
- 代码质量验证：[A+/A/B/C/D]
- 功能验证：[A+/A/B/C/D]
- 设计规范验证：[A+/A/B/C/D]

**总体评分：[A+/A/B/C/D]**

### 验收结论

[通过/不通过]

### 说明

[详细说明]

## 📝 问题清单

### 严重问题（必须修复）

[列出所有严重问题]

### 一般问题（建议修复）

[列出所有一般问题]

### 优化建议

[列出所有优化建议]

## 📦 输出产物

1. **完整的HTML文件**
   - 文件名：`[文档标题]_McKinsey风格演示(JSON模式).html`
   - 文件大小：约70KB
   - 总代码行数：约1300行

2. **JSON数据**
   - 嵌入在HTML中的JSON数据
   - 包含所有幻灯片内容
   - 结构化数据格式

3. **验收报告**
   - 资源使用验证报告
   - 内容完整性验证报告
   - JSON数据格式验证报告
   - HTML渲染功能验证报告
   - 代码质量验证报告
   - 功能验证报告
   - 最终验收报告

## 🚀 后续步骤

### 如果验收通过

1. 保存HTML文件
2. 在浏览器中测试
3. 根据需要进行微调
4. 导出JSON数据（如需要）

### 如果验收不通过

1. 根据问题清单修复问题
2. 返回对应步骤重新执行
3. 重新进行验证
4. 直到所有问题都解决

---

**报告生成时间：[日期时间]**
**验证执行者：[AI Assistant]**
```

### 输出产物

- 最终验收报告
- 问题清单
- 优化建议
- 输出产物清单

### 验证标准

- [ ] 所有验证项目都已完成
- [ ] 所有验证报告都已生成
- [ ] 最终验收结论已明确
- [ ] 问题清单已列出
- [ ] 优化建议已提供
- [ ] 输出产物已确认

---

## 🎯 成功标准

### 执行成功标志

当以下所有条件都满足时，步骤4执行成功：

**流程完成度**：
- ✅ 所有7个步骤都已执行完成
- ✅ 每个步骤的验证标准都通过
- ✅ 无步骤被跳过或中断

**资源使用验证**：
- ✅ 步骤2：已读取3个必读资源（chart-selection-guide.md、CHART_EXAMPLES_INDEX.md、INSIGHT_VISUALIZATION_GUIDE.md）
- ✅ 步骤3：已读取5个必读资源（best-practices.md、mckinsey-design-system.md、presentation-template.html、TEMPLATE_USAGE_GUIDE.md、beauty-json/SKILL.md）
- ✅ 步骤3：已读取布局和图表示例索引（INDEX.md）
- ✅ 步骤3：已检查并读取项目特定资源（.ppt_assets/INDEX.md，如果存在）

**内容完整性验证**：
- ✅ 所有原文章节都已包含（100%保留）
- ✅ 所有要点都已包含（无压缩、无省略）
- ✅ 所有数据都已包含（数值、百分比、货币等）
- ✅ 所有表格都已包含（完整的行列数据）
- ✅ 所有结论都已包含（完整文字）
- ✅ 无内容被篡改或简化
- ✅ JSON数据结构完整

**JSON数据格式验证**：
- ✅ JSON格式正确（可通过JSON.parse验证）
- ✅ JSON包含所有幻灯片数据
- ✅ 每个幻灯片包含完整内容
- ✅ 数据结构符合beauty-json/SKILL.md规范
- ✅ 无数据遗漏
- ✅ 无数据错误
- ✅ 无JSON语法错误
- ✅ 幻灯片ID连续且正确
- ✅ 幻灯片类型和模板匹配
- ✅ 图表数据完整且正确

**HTML渲染验证**：
- ✅ HTML能够正确加载JSON数据
- ✅ JavaScript能够正确解析JSON
- ✅ JavaScript能够正确渲染所有幻灯片
- ✅ 所有内容正确显示
- ✅ 所有图表正确显示
- ✅ 导航功能正常
- ✅ 响应式设计正常
- ✅ 无渲染错误

**代码质量验证**：
- ✅ HTML结构完整且正确
- ✅ CSS样式完整且符合规范
- ✅ JavaScript代码完整且无错误
- ✅ JSON数据完整且正确
- ✅ 所有图表都已正确配置
- ✅ 响应式设计完备
- ✅ 无语法错误
- ✅ 无冗余代码

**设计规范验证**（一票否决制）：
- ✅ 颜色规范：使用McKinsey标准色板，未使用紫色渐变、AI生成色板
- ✅ 字体规范：使用系统字体，未使用Inter、Roboto、Arial等通用字体
- ✅ 布局规范：未使用圆角卡片、通用模板布局
- ✅ 设计风格：符合McKinsey标准，专业、简洁、无杂乱

**功能验证**：
- ✅ HTML文件可以正常运行
- ✅ JSON数据可以正确加载
- ✅ JSON数据可以正确解析
- ✅ HTML可以正确渲染
- ✅ 所有功能都正常工作
- ✅ 图表显示正常
- ✅ 导航功能正常
- ✅ 响应式设计正常
- ✅ 浏览器兼容性良好

**输出**：McKinsey风格HTML演示文稿（JSON+HTML模式） + 验收报告

---

## 📊 预期输出

### 最终产物

1. **完整的HTML文件**
   - 文件名：`[文档标题]_McKinsey风格演示(JSON模式).html`
   - 文件大小：约70KB
   - 总代码行数：约1300行
   - 加载时间：<1秒（本地）
   - 依赖项：Chart.js CDN（唯一外部依赖）
   - 特点：JSON数据驱动，HTML动态渲染

2. **JSON数据**
   - 嵌入在HTML中的JSON数据
   - 包含所有幻灯片内容
   - 结构化数据格式
   - 易于维护和修改

3. **验收报告**
   - 资源使用验证报告
   - 内容完整性验证报告
   - JSON数据格式验证报告
   - HTML渲染功能验证报告
   - 代码质量验证报告
   - 功能验证报告
   - 最终验收报告

### 质量标准

- **代码完整性**：A+（HTML、CSS、JavaScript、JSON都完整）
- **数据完整性**：A+（100%保留所有内容）
- **JSON数据质量**：A+（格式正确，结构完整）
- **HTML渲染质量**：A+（正确渲染JSON数据）
- **代码质量**：A+（符合最佳实践）
- **设计质量**：A+（完全符合McKinsey标准）
- **功能完整性**：A+（所有功能正常）
- **总体评分**：A+（优秀）
