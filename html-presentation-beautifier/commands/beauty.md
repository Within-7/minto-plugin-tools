---
description: "将文档转化为专业 McKinsey 风格 HTML 演示文稿。严格遵循4步流程：1.文档内容分析 2.幻灯片设计与图文选择 3.转化为McKinsey风格HTML 4.代码审核检验。详见文档正文。"
args:
  - name: document
    description: "要转换的文档路径（支持 .md, .txt, .json, .html）"
    required: true
---

# Beauty 命令

将文档、数据、结论等信息转化为通俗连贯、明确清晰的 McKinsey 风格 HTML 演示文稿。

## ⚠️ 核心原则

**必须严格遵循以下4步固定流程，不得跳过任何步骤：**

**🔑 步骤2、步骤3必须读取并参考skill资源：**
- **步骤2（图文选择）**：必须读 `beauty-html/references/chart-selection-guide.md`、`beauty-html/assets/CHART_EXAMPLES_INDEX.md`、`beauty-html/assets/INSIGHT_VISUALIZATION_GUIDE.md`
- **步骤3（HTML生成）**：必须读 `beauty-html/references/best-practices.md`、`beauty-html/references/mckinsey-design-system.md`、`beauty-html/assets/presentation-template.html`、`beauty-html/assets/TEMPLATE_USAGE_GUIDE.md`

**🔑 第4步是关键验收步骤，实行一票否决制：**
- **内容完整性检验**：必须100%保留原文所有章节、数据、结论，零遗漏
- **代码质量检验**：必须符合HTML最佳实践，可访问可运行
- **资源使用检验**：必须验证步骤2和步骤3是否正确读取并使用了skill资源
- **发现问题立即回退**：返回对应步骤重新执行，绝不将就

**⚠️ Token限制处理原则（严格执行，不得偷工减料）：**

**当遇到 token 限制或上下文长度问题时，必须使用"继续"分页方式，绝对禁止：**
- ❌ 压缩或省略资源读取
- ❌ 跳过必读资源
- ❌ 简化执行步骤
- ❌ 减少生成内容
- ❌ 使用摘要代替完整内容

**正确处理方式：使用"继续"机制**
```
1. 在完成当前可执行的部分后
2. 明确说明："由于 token 限制，任务未完成，请输入'继续'以获取剩余部分"
3. 等待用户输入"继续"后
4. 继续执行剩余步骤
5. 重复直到任务完全完成
```

**关键规则：**
- ✅ **质量 > 速度**：宁可多轮对话，不可降低质量
- ✅ **完整 > 简化**：宁可分多次执行，不可压缩内容
- ✅ **标准 > 妥协**：宁可触发继续，不可偷工减料

---

## 📋 固定4步执行流程

### 步骤 1️⃣：文档内容分析合并

**目标**：完整理解源文档内容，提取关键信息，建立内容结构。

**执行方式**：调用 `beauty-step1` skill

**⚠️ 重要说明**：
- 此步骤会完整阅读源文档，不做任何修改或删减
- 如果文档过长，skill会自动使用"继续"机制分批读取
- 严禁为了省token而跳过内容或使用摘要

**输出产物**：
- 内容结构大纲（包含所有章节和要点）
- 数据点清单（所有可用于可视化的数值）
- 关键结论列表（必须完整保留）

**验证标准**：
- [ ] 所有原文内容已提取
- [ ] 无内容丢失或遗漏
- [ ] 数据点完整记录
- [ ] 逻辑结构清晰

---

### 步骤 2️⃣：幻灯片内容转换与拆分

**目标**：将文档内容完整转换为结构化的幻灯片页面，确保内容零遗漏、逻辑清晰、页面适量。

**执行方式**：调用 `beauty-step2` skill

**⚠️ 核心原则**：
- ✅ 100%保留原文所有内容，零遗漏、零压缩、零简化
- ✅ 每页内容不超过8个要点，超过则分页展示
- ✅ 遇到内容过多时，使用"继续"机制分批处理
- ❌ 绝对禁止为了省token而压缩、省略、简化内容

**🔑 必读资源**：
- `beauty-html/references/chart-selection-guide.md`
- `beauty-html/assets/CHART_EXAMPLES_INDEX.md`
- `beauty-html/assets/INSIGHT_VISUALIZATION_GUIDE.md`

**执行流程**（由skill自动执行）：
```
步骤2.1：识别文档结构层次
  ↓
步骤2.2：规划幻灯片页面类型
  ↓
步骤2.3：拆分内容到具体页面
  ↓
步骤2.4：验证内容完整性
```

**输出产物**：
- 完整的幻灯片页面清单（从第1页到第N页）
- 每页的详细内容（100%原文，无压缩）
- 每页的数据点、图表、表格（如有）
- 页面总数确认

**验证标准**：
- [ ] 所有页面已详细列出
- [ ] 每页内容完整（100%原文）
- [ ] 每页要点数≤8个
- [ ] 数据、图表、表格完整
- [ ] 页面编号连续
- [ ] 无内容遗漏

---

### 步骤 3️⃣：HTML样式布局代码规划与生成

**目标**：将步骤2生成的幻灯片页面清单转换为完整的、可运行的McKinsey风格HTML文件。

**执行方式**：调用 `beauty-step3` skill

**⚠️ 核心原则**：
- ✅ 必须读取并参考skill资源
- ✅ **强制使用** `best-practices.md` 和 `mckinsey-design-system.md` 中的所有设计规范
- ✅ **颜色规范强制执行**：必须使用McKinsey标准色板，禁止使用紫色渐变、AI生成色板
- ✅ **字体规范强制执行**：必须使用系统字体，禁止使用Inter、Roboto、Arial等通用字体
- ✅ **布局规范强制执行**：必须遵循McKinsey布局标准，禁止使用圆角卡片、通用模板
- ✅ 每个阶段的代码必须是完整的语法单元
- ✅ CSS必须在阶段1一次性完整生成
- ✅ 每个幻灯片的HTML必须完整
- ✅ JavaScript必须在阶段4完整生成
- ✅ 每个阶段结束后提示用户输入"继续"
- ❌ 禁止跨阶段截断HTML标签
- ❌ 禁止省略CSS样式
- ❌ 禁止简化图表代码
- ❌ **禁止使用非McKinsey风格的设计元素**（紫色渐变、圆角卡片、通用模板等）

**🔑 必读资源（强制执行）**：
- `beauty-html/references/best-practices.md` - **必须严格遵循所有最佳实践**
- `beauty-html/references/mckinsey-design-system.md` - **必须严格遵循所有设计规范**
- `beauty-html/assets/presentation-template.html` - 参考模板结构
- `beauty-html/assets/TEMPLATE_USAGE_GUIDE.md` - 模板使用指南

**执行流程**（由skill自动执行）：
```
步骤3.1：读取必读资源
  ↓
步骤3.2：为每页规划代码方案
  ↓
步骤3.3：生成完整HTML文件（3个阶段）
  ├─ 阶段1：生成HTML框架和完整CSS样式
  ├─ 阶段2：按章节逐个生成幻灯片（封面页、目录页、章节首页、内容页、结束页）
  └─ 阶段3：生成JavaScript代码和结束标签
  ↓
步骤3.4：验证代码质量
```

**输出产物**：
- 完整的HTML文件（约1200行）
- CSS样式（约800行）
- JavaScript代码（约100行）
- 图表配置（根据实际需求）

**验证标准**：

**代码完整性**：
- [ ] HTML结构完整
- [ ] CSS样式完整
- [ ] JavaScript功能完整
- [ ] 所有图表已配置
- [ ] 响应式设计完备
- [ ] 无语法错误

**设计规范强制检查（一票否决制）**：

**颜色规范检查**：
- [ ] 使用McKinsey标准色板（#FFFFFF, #000000, #F85d42, #74788d, #556EE6, #34c38f, #50a5f1, #f1b44c）
- [ ] 未使用紫色渐变背景
- [ ] 未使用AI生成的色板
- [ ] 未使用非McKinsey颜色组合
- [ ] 主色调为白色背景+黑色标题
- [ ] 强调色使用正确（#F85d42用于关键高亮）
- [ ] 图表颜色使用标准色板
- [ ] 对比度符合可读性标准（≥4.5:1）

**字体规范检查**：
- [ ] 使用系统字体（-apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC"等）
- [ ] 未使用Inter、Roboto、Arial等通用字体
- [ ] 标题字体大小符合规范（48-64px）
- [ ] 副标题字体大小符合规范（28-36px）
- [ ] 正文字体大小符合规范（16-20px）
- [ ] 图表标签字体大小符合规范（12-14px）
- [ ] 字体粗细使用正确（标题bold，正文regular）
- [ ] 行高符合规范（1.6-1.8）

**布局规范检查**：
- [ ] 未使用圆角卡片（border-radius: 8px等）
- [ ] 未使用通用模板布局
- [ ] 边距符合规范（40-60px）
- [ ] 元素间距符合规范（20-30px）
- [ ] 两列布局间距符合规范（30-40px）
- [ ] 图表容器最小高度符合规范（400px）
- [ ] 所有元素对齐到网格
- [ ] 视觉平衡良好

**设计风格检查**：
- [ ] 整体风格符合McKinsey标准
- [ ] 无装饰性图标或图形
- [ ] 无不必要的动画效果
- [ ] 阴影使用最小化（0-2px）
- [ ] 边框使用最小化（仅在需要时使用）
- [ ] 白空间充足（不拥挤）
- [ ] 专业、简洁、无杂乱

---

### 步骤 4️⃣：代码内容审核检验

**⚠️ 最关键步骤！必须严格执行！**

**目标**：全面检查生成的 HTML 演示文稿，确保质量和完整性。

**执行方式**：调用 `beauty-step4` skill

**⚠️ 核心原则**：实行一票否决制
- **内容完整性检验**：必须100%保留原文所有章节、数据、结论，零遗漏
- **代码质量检验**：必须符合HTML最佳实践，可访问可运行
- **资源使用检验**：必须验证步骤2和步骤3是否正确读取并使用了skill资源
- **发现问题立即回退**：返回对应步骤重新执行，绝不将就

**执行流程**（由skill自动执行）：
```
步骤4.1：资源使用验证
  ↓
步骤4.2：内容完整性检查
  ↓
步骤4.3：代码质量检查
  ↓
步骤4.4：功能验证
  ↓
步骤4.5：生成最终报告
```

**验证项目**：

#### 资源使用验证
```
步骤2资源：
□ 已读取：references/chart-selection-guide.md
□ 已读取：assets/CHART_EXAMPLES_INDEX.md
□ 已读取：assets/INSIGHT_VISUALIZATION_GUIDE.md

步骤3资源：
□ 已读取：references/best-practices.md
□ 已读取：references/mckinsey-design-system.md
□ 已读取：assets/presentation-template.html
□ 已读取：assets/TEMPLATE_USAGE_GUIDE.md
```

#### 内容完整性检查
```
□ 所有章节都已包含
□ 所有要点都已包含
□ 所有数据都已包含
□ 所有表格都已包含
□ 所有结论都已包含
□ 无内容被压缩或省略
□ 无内容被篡改或简化
```

#### 代码质量检查
```
□ HTML结构正确
□ CSS样式正确
□ JavaScript代码正确
□ 可访问性符合标准
□ 性能优化合理
□ 无语法错误
□ 无冗余代码
```

#### 设计规范验证（一票否决制）
```
**颜色规范验证**：
□ 使用McKinsey标准色板（#FFFFFF, #000000, #F85d42, #74788d, #556EE6, #34c38f, #50a5f1, #f1b44c）
□ 未使用紫色渐变背景
□ 未使用AI生成的色板
□ 未使用非McKinsey颜色组合
□ 主色调为白色背景+黑色标题
□ 强调色使用正确（#F85d42用于关键高亮）
□ 图表颜色使用标准色板
□ 对比度符合可读性标准（≥4.5:1）

**字体规范验证**：
□ 使用系统字体（-apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC"等）
□ 未使用Inter、Roboto、Arial等通用字体
□ 标题字体大小符合规范（48-64px）
□ 副标题字体大小符合规范（28-36px）
□ 正文字体大小符合规范（16-20px）
□ 图表标签字体大小符合规范（12-14px）
□ 字体粗细使用正确（标题bold，正文regular）
□ 行高符合规范（1.6-1.8）

**布局规范验证**：
□ 未使用圆角卡片（border-radius: 8px等）
□ 未使用通用模板布局
□ 边距符合规范（40-60px）
□ 元素间距符合规范（20-30px）
□ 两列布局间距符合规范（30-40px）
□ 图表容器最小高度符合规范（400px）
□ 所有元素对齐到网格
□ 视觉平衡良好

**设计风格验证**：
□ 整体风格符合McKinsey标准
□ 无装饰性图标或图形
□ 无不必要的动画效果
□ 阴影使用最小化（0-2px）
□ 边框使用最小化（仅在需要时使用）
□ 白空间充足（不拥挤）
□ 专业、简洁、无杂乱
```

#### 功能验证
```
□ 基本功能正常
□ 图表显示正常
□ 响应式设计正常
□ 浏览器兼容性良好
□ 无功能性问题
```

**输出产物**：
- 资源使用验证报告
- 内容完整性验证报告
- 代码质量验证报告
- 功能验证报告
- 最终验收报告

**验证标准**：
- [ ] 所有验证项目都通过
- [ ] 无严重问题
- [ ] 可正常运行
- [ ] 符合McKinsey标准
- [ ] **设计规范全部符合**（颜色、字体、布局、风格）
- [ ] **未使用非McKinsey风格元素**（紫色渐变、圆角卡片、通用模板等）

---

## 🚀 执行流程总览

```
开始执行 Beauty 命令
  ↓
步骤1：调用 beauty-step1 skill
  ├─ 文档内容分析合并
  ├─ 生成内容结构大纲
  ├─ 生成数据点清单
  └─ 生成关键结论列表
  ↓
步骤2：调用 beauty-step2 skill
  ├─ 读取必读资源（3个）
  ├─ 识别文档结构层次
  ├─ 规划幻灯片页面类型
  ├─ 拆分内容到具体页面
  └─ 验证内容完整性
  ↓
步骤3：调用 beauty-step3 skill
  ├─ 读取必读资源（4个）
  ├─ 为每页规划代码方案
  ├─ 生成完整HTML文件（4个阶段）
  └─ 验证代码质量
  ↓
步骤4：调用 beauty-step4 skill
  ├─ 资源使用验证
  ├─ 内容完整性检查
  ├─ 代码质量检查
  ├─ 功能验证
  └─ 生成最终报告
  ↓
完成！输出最终HTML文件和验收报告
```

---

## ⚠️ 回退机制

### 回退触发条件

以下任一情况发生，必须回退到对应步骤重新执行：

#### 回退到步骤1
```
□ 文档分析不完整
□ 章节结构识别错误
□ 数据点遗漏
□ 结论遗漏
```

#### 回退到步骤2
```
□ 资源未读取（chart-selection-guide.md等）
□ 图表选择错误
□ 内容被压缩或省略
□ 分页不合理
□ 页面遗漏
```

#### 回退到步骤3
```
□ 资源未读取（best-practices.md等）
□ HTML结构错误
□ CSS样式错误
□ JavaScript代码错误
□ 图表配置错误
□ 响应式设计问题
□ **颜色规范不符合**（使用紫色渐变、AI生成色板、非McKinsey颜色）
□ **字体规范不符合**（使用Inter、Roboto、Arial等通用字体）
□ **布局规范不符合**（使用圆角卡片、通用模板布局）
□ **设计风格不符合**（装饰性图标、不必要动画、过度阴影等）
```

### 回退执行流程

```
发现问题
  ↓
确定回退目标步骤
  ↓
记录问题详情
  ↓
输出回退建议
  ↓
等待用户确认
  ↓
返回对应步骤重新执行
  ↓
重新验证
  ↓
通过后继续
```

---

## 📊 预期输出

### 最终产物

1. **完整的HTML文件**
   - 文件名：`[文档标题]_McKinsey风格演示文稿.html`
   - 文件大小：约60KB
   - 总代码行数：约1200行
   - 加载时间：<1秒（本地）
   - 依赖项：Chart.js CDN（唯一外部依赖）

2. **验收报告**
   - 资源使用验证报告
   - 内容完整性验证报告
   - 代码质量验证报告
   - 功能验证报告
   - 最终验收报告

### 质量标准

- **内容完整性**：A+（100%保留）
- **代码质量**：A+（符合最佳实践）
- **设计质量**：A+（完全符合McKinsey标准）
- **功能完整性**：A+（所有功能正常）
- **总体评分**：A+（优秀）

---

## 💡 使用建议

1. **首次使用**：建议先用小文档测试，熟悉流程
2. **文档准备**：确保文档格式规范（.md, .txt, .json, .html）
3. **Token管理**：遇到token限制时，耐心等待"继续"提示
4. **质量检查**：步骤4是关键验收步骤，务必认真执行
5. **浏览器测试**：生成后在不同浏览器中测试效果

---

## 🎯 成功标准

Beauty命令执行成功的标准：

- ✅ 所有4个步骤都已完成
- ✅ 所有必读资源都已读取
- ✅ 所有内容都已100%保留
- ✅ HTML文件可以正常运行
- ✅ 所有功能都正常工作
- ✅ 符合McKinsey设计标准
- ✅ 验收报告全部通过

---

## 📝 注意事项

1. **不要跳过任何步骤**：每个步骤都有其重要性，必须按顺序执行
2. **不要偷工减料**：宁可多轮对话，不可降低质量
3. **不要压缩内容**：宁可分批处理，不可省略细节
4. **不要跳过资源**：所有必读资源都必须完整读取
5. **不要忽略验证**：步骤4的验收是关键，必须严格执行

---

## 🔧 故障排除

### 问题1：步骤1无法读取完整文档

**解决方案**：
- 使用"继续"机制分批读取
- 检查文档路径是否正确
- 确认文档格式是否支持

### 问题2：步骤2图表选择错误

**解决方案**：
- 返回步骤2重新执行
- 仔细阅读chart-selection-guide.md
- 根据决策树重新选择

### 问题3：步骤3HTML生成不完整

**解决方案**：
- 返回步骤3重新执行
- 确保所有资源都已读取
- 使用"继续"机制分批生成

### 问题4：步骤4验证不通过

**解决方案**：
- 根据验证报告返回对应步骤
- 修复问题后重新执行
- 确保所有验证项目都通过

---

## 📚 相关资源

### Skill文档
- `.trae/skills/beauty-step1/SKILL.md` - 步骤1：文档内容分析合并
- `.trae/skills/beauty-step2/SKILL.md` - 步骤2：幻灯片内容转换与拆分
- `.trae/skills/beauty-step3/SKILL.md` - 步骤3：HTML样式布局代码规划与生成
- `.trae/skills/beauty-step4/SKILL.md` - 步骤4：代码内容审核检验

### 参考资源
- `beauty-html/references/chart-selection-guide.md` - 图表选择指南
- `beauty-html/references/best-practices.md` - HTML最佳实践
- `beauty-html/references/mckinsey-design-system.md` - McKinsey设计系统
- `beauty-html/assets/presentation-template.html` - 演示文稿模板
- `beauty-html/assets/TEMPLATE_USAGE_GUIDE.md` - 模板使用指南
- `beauty-html/assets/CHART_EXAMPLES_INDEX.md` - 图表示例索引
- `beauty-html/assets/INSIGHT_VISUALIZATION_GUIDE.md` - 观点可视化指南

---

**Beauty命令执行完毕！**
