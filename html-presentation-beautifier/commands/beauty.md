---
description: "将文档转化为专业 McKinsey 风格 HTML 演示文稿。严格遵循4步流程：文档分析 → 幻灯片设计 → HTML生成 → 代码审核，确保100%内容保留和McKinsey设计标准。"
args:
  - name: document
    description: "要转换的文档路径（支持 .md, .txt, .json, .html）"
    required: true
---

# Beauty 命令

将文档、数据、结论等信息转化为通俗连贯、明确清晰的 McKinsey 风格 HTML 演示文稿。

## ⚠️ 核心原则

**必须严格遵循以下4步固定流程，不得跳过任何步骤：**

**🔑 步骤2、步骤3必须读取并参考skill资源：**
- **步骤2（图文选择）**：必须读 `beauty-html/references/chart-selection-guide.md`、`beauty-html/assets/CHART_EXAMPLES_INDEX.md`、`beauty-html/assets/INSIGHT_VISUALIZATION_GUIDE.md`
- **步骤3（HTML生成）**：必须读 `beauty-html/references/best-practices.md`、`beauty-html/references/mckinsey-design-system.md`、`beauty-html/assets/presentation-template.html`、`beauty-html/assets/TEMPLATE_USAGE_GUIDE.md`

**🔑 第4步是关键验收步骤，实行一票否决制：**
- **内容完整性检验**：必须100%保留原文所有章节、数据、结论，零遗漏
- **代码质量检验**：必须符合HTML最佳实践，可访问可运行
- **资源使用检验**：必须验证步骤2和步骤3是否正确读取并使用了skill资源
- **发现问题立即回退**：返回对应步骤重新执行，绝不将就

**⚠️ Token限制处理原则（严格执行，不得偷工减料）：**

**🔑 最核心规则（必须严格遵守）：如果数据内容过大，或者token过长，则自动使用'继续'进行'分段'加载数据，绝对不能精简、偷工减料的节省token,严禁为了省token而跳过内容或使用摘要**

**当遇到 token 限制或上下文长度问题时，必须使用"继续"分页方式，绝对禁止：**
- ❌ 压缩或省略资源读取
- ❌ 跳过必读资源
- ❌ 简化执行步骤
- ❌ 减少生成内容
- ❌ 使用摘要代替完整内容
- ❌ 精简数据内容
- ❌ 偷工减料节省token

**正确处理方式：使用"继续"机制**
```
1. 在完成当前可执行的部分后
2. 明确说明："由于 token 限制，任务未完成，请输入'继续'以获取剩余部分"
3. 等待用户输入"继续"后
4. 继续执行剩余步骤
5. 重复直到任务完全完成
```

**分段加载原则：**
- ✅ **完整保留**：每段数据都必须100%保留，无遗漏、无压缩
- ✅ **分段清晰**：明确标注当前是第几段，共几段
- ✅ **连续执行**：每段完成后自动提示"继续"，等待用户确认
- ✅ **质量优先**：宁可多轮对话，不可降低质量
- ❌ **禁止精简**：绝对不能为了省token而精简数据内容
- ❌ **禁止偷工**：绝对不能为了省token而偷工减料

**关键规则：**
- ✅ **质量 > 速度**：宁可多轮对话，不可降低质量
- ✅ **完整 > 简化**：宁可分多次执行，不可压缩内容
- ✅ **标准 > 妥协**：宁可触发继续，不可偷工减料

---

## 📋 固定4步执行流程

### 步骤 1️⃣：文档内容分析合并

**目标**：完整理解源文档内容，提取关键信息，建立内容结构。

**执行方式**：调用 `beauty-step1` skill

**⚠️ 重要说明**：
- 此步骤会完整阅读源文档，不做任何修改或删减
- 如果文档过长，skill会自动使用"继续"机制分批读取
- **🔑 最核心规则：绝对不能精简、偷工减料节省token**
- **🔑 核心原则：如果数据内容过大，或者token过长，则自动使用'继续'进行'分段'加载数据，100%保留所有内容,严禁为了省token而跳过内容或使用摘要**

**输出产物**：
- 内容结构大纲（包含所有章节和要点）
- 数据点清单（所有可用于可视化的数值）
- 关键结论列表（必须完整保留）

**验证标准**：
- [ ] 所有原文内容已提取
- [ ] 无内容丢失或遗漏
- [ ] 数据点完整记录
- [ ] 逻辑结构清晰

---

### 步骤 2️⃣：幻灯片内容转换与拆分

**目标**：将文档内容完整转换为结构化的幻灯片页面，确保内容零遗漏、逻辑清晰、页面适量。

**执行方式**：调用 `beauty-step2` skill

**⚠️ 核心原则**：
- ✅ 100%保留原文所有内容，零遗漏、零压缩、零简化
- ✅ 每页内容不超过8个要点，超过则分页展示
- ✅ 遇到内容过多时，使用"继续"机制分批处理
- ❌ 绝对禁止为了省token而压缩、省略、简化内容
- **🔑 最核心规则：如果数据内容过大，或者token过长，则自动使用'继续'进行'分段'加载数据，绝对不能精简、偷工减料的节省token,严禁为了省token而跳过内容或使用摘要**

**🔑 必读资源**：
- `beauty-html/references/chart-selection-guide.md`
- `beauty-html/assets/CHART_EXAMPLES_INDEX.md`
- `beauty-html/assets/INSIGHT_VISUALIZATION_GUIDE.md`

**执行流程**（由skill自动执行）：
```
步骤2.1：识别文档结构层次
  ↓
步骤2.2：规划幻灯片页面类型
  ↓
步骤2.3：拆分内容到具体页面
  ↓
步骤2.4：验证内容完整性
```

**输出产物**：
- 完整的幻灯片页面清单（从第1页到第N页）
- 每页的详细内容（100%原文，无压缩）
- 每页的数据点、图表、表格（如有）
- 页面总数确认

**验证标准**：
- [ ] 所有页面已详细列出
- [ ] 每页内容完整（100%原文）
- [ ] 每页要点数≤8个
- [ ] 数据、图表、表格完整
- [ ] 页面编号连续
- [ ] 无内容遗漏

---

### 步骤 3️⃣：HTML样式布局代码规划与生成

**目标**：将步骤2生成的幻灯片页面清单转换为完整的、可运行的McKinsey风格HTML文件。

**执行方式**：调用 `beauty-step3` skill

**⚠️ 核心原则**：
- ✅ 必须读取并参考skill资源
- ✅ **强制使用** `best-practices.md` 和 `mckinsey-design-system.md` 中的所有设计规范
- ✅ **颜色规范强制执行**：必须使用McKinsey标准色板，禁止使用紫色渐变、AI生成色板
- ✅ **字体规范强制执行**：必须使用系统字体，禁止使用Inter、Roboto、Arial等通用字体
- ✅ **布局规范强制执行**：必须遵循McKinsey布局标准，禁止使用圆角卡片、通用模板
- ✅ 每个阶段的代码必须是完整的语法单元
- ✅ CSS必须在阶段1一次性完整生成
- ✅ 每个幻灯片的HTML必须完整
- ✅ JavaScript必须在阶段4完整生成
- ✅ 每个阶段结束后提示用户输入"继续"
- ❌ 禁止跨阶段截断HTML标签
- ❌ 禁止省略CSS样式
- ❌ 禁止简化图表代码
- ❌ **禁止使用非McKinsey风格的设计元素**（紫色渐变、圆角卡片、通用模板等）
- **🔑 最核心规则：如果数据内容过大，或者token过长，则自动使用'继续'进行'分段'加载数据，绝对不能精简、偷工减料的节省token,严禁为了省token而跳过内容或使用摘要**

**🔑 必读资源（强制执行）**：
- `beauty-html/references/best-practices.md` - **必须严格遵循所有最佳实践**
- `beauty-html/references/mckinsey-design-system.md` - **必须严格遵循所有设计规范**
- `beauty-html/assets/presentation-template.html` - 参考模板结构
- `beauty-html/assets/TEMPLATE_USAGE_GUIDE.md` - 模板使用指南

**执行流程**（由skill自动执行）：
```
步骤3.1：读取必读资源
  ↓
步骤3.2：为每页规划代码方案
  ↓
步骤3.3：生成完整HTML文件（3个阶段）
  ├─ 阶段1：生成HTML框架和完整CSS样式
  ├─ 阶段2：按章节逐个生成幻灯片（封面页、目录页、章节首页、内容页、结束页）
  └─ 阶段3：生成JavaScript代码和结束标签
  ↓
步骤3.4：验证代码质量
```

**输出产物**：
- 完整的HTML文件（约1200行）
- CSS样式（约800行）
- JavaScript代码（约100行）
- 图表配置（根据实际需求）

**验证标准**：

**代码完整性**：
- [ ] HTML结构完整
- [ ] CSS样式完整
- [ ] JavaScript功能完整
- [ ] 所有图表已配置
- [ ] 响应式设计完备
- [ ] 无语法错误

**设计规范强制检查（一票否决制）**：

**颜色规范检查**：
- [ ] 使用McKinsey标准色板（#FFFFFF, #000000, #F85d42, #74788d, #556EE6, #34c38f, #50a5f1, #f1b44c）
- [ ] 未使用紫色渐变背景
- [ ] 未使用AI生成的色板
- [ ] 未使用非McKinsey颜色组合
- [ ] 主色调为白色背景+黑色标题
- [ ] 强调色使用正确（#F85d42用于关键高亮）
- [ ] 图表颜色使用标准色板
- [ ] 对比度符合可读性标准（≥4.5:1）

**字体规范检查**：
- [ ] 使用系统字体（-apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC"等）
- [ ] 未使用Inter、Roboto、Arial等通用字体
- [ ] 标题字体大小符合规范（48-64px）
- [ ] 副标题字体大小符合规范（28-36px）
- [ ] 正文字体大小符合规范（16-20px）
- [ ] 图表标签字体大小符合规范（12-14px）
- [ ] 字体粗细使用正确（标题bold，正文regular）
- [ ] 行高符合规范（1.6-1.8）

**布局规范检查**：
- [ ] 未使用圆角卡片（border-radius: 8px等）
- [ ] 未使用通用模板布局
- [ ] 边距符合规范（40-60px）
- [ ] 元素间距符合规范（20-30px）
- [ ] 两列布局间距符合规范（30-40px）
- [ ] 图表容器最小高度符合规范（400px）
- [ ] 所有元素对齐到网格
- [ ] 视觉平衡良好

**设计风格检查**：
- [ ] 整体风格符合McKinsey标准
- [ ] 无装饰性图标或图形
- [ ] 无不必要的动画效果
- [ ] 阴影使用最小化（0-2px）
- [ ] 边框使用最小化（仅在需要时使用）
- [ ] 白空间充足（不拥挤）
- [ ] 专业、简洁、无杂乱

---

### 步骤 4️⃣：代码内容审核检验

**⚠️ 最关键步骤！必须严格执行！**

**目标**：全面检查生成的 HTML 演示文稿，确保质量和完整性。

**执行方式**：调用 `beauty-step4` skill

**⚠️ 核心原则**：实行一票否决制
- **内容完整性检验**：必须100%保留原文所有章节、数据、结论，零遗漏
- **代码质量检验**：必须符合HTML最佳实践，可访问可运行
- **资源使用检验**：必须验证步骤2和步骤3是否正确读取并使用了skill资源
- **发现问题立即回退**：返回对应步骤重新执行，绝不将就

**执行流程**（由skill自动执行）：
```
步骤4.1：资源使用验证
  ↓
步骤4.2：内容完整性检查
  ↓
步骤4.3：代码质量检查
  ↓
步骤4.4：功能验证
  ↓
步骤4.5：生成最终报告
```

**验证项目**：

#### 资源使用验证
```
步骤2资源：
□ 已读取：references/chart-selection-guide.md
□ 已读取：assets/CHART_EXAMPLES_INDEX.md
□ 已读取：assets/INSIGHT_VISUALIZATION_GUIDE.md

步骤3资源：
□ 已读取：references/best-practices.md
□ 已读取：references/mckinsey-design-system.md
□ 已读取：assets/presentation-template.html
□ 已读取：assets/TEMPLATE_USAGE_GUIDE.md
```

#### 内容完整性检查
```
□ 所有章节都已包含
□ 所有要点都已包含
□ 所有数据都已包含
□ 所有表格都已包含
□ 所有结论都已包含
□ 无内容被压缩或省略
□ 无内容被篡改或简化
```

#### 代码质量检查
```
□ HTML结构正确
□ CSS样式正确
□ JavaScript代码正确
□ 可访问性符合标准
□ 性能优化合理
□ 无语法错误
□ 无冗余代码
```

#### 设计规范验证（一票否决制）
```
**颜色规范验证**：
□ 使用McKinsey标准色板（#FFFFFF, #000000, #F85d42, #74788d, #556EE6, #34c38f, #50a5f1, #f1b44c）
□ 未使用紫色渐变背景
□ 未使用AI生成的色板
□ 未使用非McKinsey颜色组合
□ 主色调为白色背景+黑色标题
□ 强调色使用正确（#F85d42用于关键高亮）
□ 图表颜色使用标准色板
□ 对比度符合可读性标准（≥4.5:1）

**字体规范验证**：
□ 使用系统字体（-apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC"等）
□ 未使用Inter、Roboto、Arial等通用字体
□ 标题字体大小符合规范（48-64px）
□ 副标题字体大小符合规范（28-36px）
□ 正文字体大小符合规范（16-20px）
□ 图表标签字体大小符合规范（12-14px）
□ 字体粗细使用正确（标题bold，正文regular）
□ 行高符合规范（1.6-1.8）

**布局规范验证**：
□ 未使用圆角卡片（border-radius: 8px等）
□ 未使用通用模板布局
□ 边距符合规范（40-60px）
□ 元素间距符合规范（20-30px）
□ 两列布局间距符合规范（30-40px）
□ 图表容器最小高度符合规范（400px）
□ 所有元素对齐到网格
□ 视觉平衡良好

**设计风格验证**：
□ 整体风格符合McKinsey标准
□ 无装饰性图标或图形
□ 无不必要的动画效果
□ 阴影使用最小化（0-2px）
□ 边框使用最小化（仅在需要时使用）
□ 白空间充足（不拥挤）
□ 专业、简洁、无杂乱
```

#### 功能验证
```
□ 基本功能正常
□ 图表显示正常
□ 响应式设计正常
□ 浏览器兼容性良好
□ 无功能性问题
```

**输出产物**：
- 资源使用验证报告
- 内容完整性验证报告
- 代码质量验证报告
- 功能验证报告
- 最终验收报告

**验证标准**：
- [ ] 所有验证项目都通过
- [ ] 无严重问题
- [ ] 可正常运行
- [ ] 符合McKinsey标准
- [ ] **设计规范全部符合**（颜色、字体、布局、风格）
- [ ] **未使用非McKinsey风格元素**（紫色渐变、圆角卡片、通用模板等）

---

## 🚀 执行流程

### 自动化执行流程

本命令会自动调用以下4个skill，按顺序执行：

```
开始
  ↓
步骤1：beauty-step1
  ├─ 读取源文档
  ├─ 分析内容结构
  ├─ 提取数据点
  └─ 生成内容大纲
  ↓
步骤2：beauty-step2
  ├─ 读取图表选择指南
  ├─ 规划幻灯片页面
  ├─ 拆分内容到页面
  └─ 验证内容完整性
  ↓
步骤3：beauty-step3
  ├─ 读取设计规范和模板
  ├─ 规划代码方案
  ├─ 生成HTML、CSS、JavaScript
  └─ 验证代码质量
  ↓
步骤4：beauty-step4
  ├─ 验证资源使用
  ├─ 检查内容完整性
  ├─ 检查代码质量
  ├─ 验证设计规范
  └─ 生成验收报告
  ↓
完成！输出HTML文件和验收报告
```

### 执行保证

- ✅ **自动执行**：所有步骤自动调用，无需手动干预
- ✅ **质量保证**：每步都有验证标准，确保质量
- ✅ **错误恢复**：发现问题自动回退到对应步骤
- ✅ **完整保留**：100%保留原文所有内容
- ✅ **设计标准**：严格遵循McKinsey设计规范

---

## ⚠️ 回退机制

### 回退触发条件

以下任一情况发生，必须回退到对应步骤重新执行：

#### 回退到步骤1
```
□ 文档分析不完整
□ 章节结构识别错误
□ 数据点遗漏
□ 结论遗漏
```

#### 回退到步骤2
```
□ 资源未读取（chart-selection-guide.md等）
□ 图表选择错误
□ 内容被压缩或省略
□ 分页不合理
□ 页面遗漏
```

#### 回退到步骤3
```
□ 资源未读取（best-practices.md等）
□ HTML结构错误
□ CSS样式错误
□ JavaScript代码错误
□ 图表配置错误
□ 响应式设计问题
□ **颜色规范不符合**（使用紫色渐变、AI生成色板、非McKinsey颜色）
□ **字体规范不符合**（使用Inter、Roboto、Arial等通用字体）
□ **布局规范不符合**（使用圆角卡片、通用模板布局）
□ **设计风格不符合**（装饰性图标、不必要动画、过度阴影等）
```

### 回退执行流程

```
发现问题
  ↓
确定回退目标步骤
  ↓
记录问题详情
  ↓
输出回退建议
  ↓
等待用户确认
  ↓
返回对应步骤重新执行
  ↓
重新验证
  ↓
通过后继续
```

---

## 📊 预期输出

### 最终产物

1. **完整的HTML文件**
   - 文件名：`[文档标题]_McKinsey风格演示文稿.html`
   - 文件大小：约60KB
   - 总代码行数：约1200行
   - 加载时间：<1秒（本地）
   - 依赖项：Chart.js CDN（唯一外部依赖）

2. **验收报告**
   - 资源使用验证报告
   - 内容完整性验证报告
   - 代码质量验证报告
   - 功能验证报告
   - 最终验收报告

### 质量标准

- **内容完整性**：A+（100%保留）
- **代码质量**：A+（符合最佳实践）
- **设计质量**：A+（完全符合McKinsey标准）
- **功能完整性**：A+（所有功能正常）
- **总体评分**：A+（优秀）

---

## 💡 使用建议

### 最佳实践

**1. 文档准备**
- 使用结构化的文档格式（Markdown、HTML、JSON优先）
- 确保文档包含清晰的章节层次
- 提供完整的数据和结论
- 避免使用过于复杂的嵌套结构

**2. 首次使用**
- 建议先用小文档（<10页）测试
- 熟悉4步执行流程
- 了解验证标准和回退机制
- 确认输出符合预期

**3. Token管理**
- 遇到token限制时，耐心等待"继续"提示
- 不要中断执行，等待完整完成
- 大文档会自动分批处理
- 质量优先于速度

**4. 质量检查**
- 步骤4是关键验收步骤，务必认真执行
- 所有验证项目都必须通过
- 发现问题立即回退修复
- 不要忽略任何警告

**5. 浏览器测试**
- 生成后在不同浏览器中测试效果
- 推荐浏览器：Chrome、Firefox、Safari、Edge
- 测试响应式设计（桌面、平板、手机）
- 验证图表显示和交互

### 常见问题

**Q1：执行时间过长怎么办？**
A：这是正常的，特别是对于大文档。系统会自动分批处理，请耐心等待"继续"提示。

**Q2：如何确保设计符合McKinsey标准？**
A：系统会自动验证设计规范，包括颜色、字体、布局。如果不符合，会自动回退到步骤3重新生成。

**Q3：可以跳过某些步骤吗？**
A：不可以。所有4个步骤都必须执行，每个步骤都有其重要性。跳过步骤会导致质量下降。

**Q4：如何处理项目特定的需求？**
A：在项目根目录下创建 `.ppt_assets/INDEX.md` 文件，定义项目特定的布局、图表和样式。系统会优先使用项目资源。

**Q5：生成的HTML文件可以修改吗？**
A：可以。生成的HTML文件是标准的HTML5格式，可以直接用任何文本编辑器修改。但建议在修改后重新运行步骤4验证。

---

## 🎯 成功标准

### 执行成功标志

当以下所有条件都满足时，命令执行成功：

**流程完成度**：
- ✅ 所有4个步骤都已执行完成
- ✅ 每个步骤的验证标准都通过
- ✅ 无步骤被跳过或中断

**资源使用验证**：
- ✅ 步骤2：已读取3个必读资源（chart-selection-guide.md、CHART_EXAMPLES_INDEX.md、INSIGHT_VISUALIZATION_GUIDE.md）
- ✅ 步骤3：已读取4个必读资源（best-practices.md、mckinsey-design-system.md、presentation-template.html、TEMPLATE_USAGE_GUIDE.md）
- ✅ 步骤3：已读取布局和图表示例索引（INDEX.md）
- ✅ 步骤3：已检查并读取项目特定资源（.ppt_assets/INDEX.md，如果存在）

**内容完整性验证**：
- ✅ 所有原文章节都已包含（100%保留）
- ✅ 所有要点都已包含（无压缩、无省略）
- ✅ 所有数据都已包含（数值、百分比、货币等）
- ✅ 所有表格都已包含（完整的行列数据）
- ✅ 所有结论都已包含（完整文字）
- ✅ 无内容被篡改或简化

**代码质量验证**：
- ✅ HTML结构完整且正确
- ✅ CSS样式完整且符合规范
- ✅ JavaScript代码完整且无错误
- ✅ 所有图表都已正确配置
- ✅ 响应式设计完备
- ✅ 无语法错误

**设计规范验证**（一票否决制）：
- ✅ 颜色规范：使用McKinsey标准色板，未使用紫色渐变、AI生成色板
- ✅ 字体规范：使用系统字体，未使用Inter、Roboto、Arial等通用字体
- ✅ 布局规范：未使用圆角卡片、通用模板布局
- ✅ 设计风格：符合McKinsey标准，专业、简洁、无杂乱

**功能验证**：
- ✅ HTML文件可以正常运行
- ✅ 所有功能都正常工作
- ✅ 图表显示正常
- ✅ 导航功能正常
- ✅ 响应式设计正常

**验收报告**：
- ✅ 验收报告全部通过
- ✅ 无严重问题
- ✅ 无设计规范违规

### 输出文件

成功执行后会生成以下文件：

**1. HTML演示文稿文件**
```
文件名：[文档标题]_McKinsey风格演示文稿.html
文件大小：约60KB
代码行数：约1200行
格式：HTML5
依赖项：Chart.js CDN（https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js）
```

**2. 验收报告**
```
包含以下内容：
- 资源使用验证报告
- 内容完整性验证报告
- 代码质量验证报告
- 设计规范验证报告
- 功能验证报告
- 最终验收报告
- 质量评分（A+为最高）
```

### 执行失败情况

如果出现以下情况，命令执行失败：

**步骤1失败**：
- ❌ 无法读取源文档
- ❌ 文档格式不支持
- ❌ 文档内容为空

**步骤2失败**：
- ❌ 无法读取必读资源
- ❌ 内容被压缩或省略
- ❌ 页面规划不合理

**步骤3失败**：
- ❌ 无法读取必读资源
- ❌ HTML生成不完整
- ❌ 设计规范不符合（使用非McKinsey风格）
- ❌ 代码存在严重错误

**步骤4失败**：
- ❌ 验证不通过
- ❌ 存在设计规范违规
- ❌ 存在内容遗漏

**失败处理**：
- 自动回退到失败的步骤
- 提供详细的失败原因
- 给出修复建议
- 等待用户确认后重新执行

---

## 📝 注意事项

1. **不要跳过任何步骤**：每个步骤都有其重要性，必须按顺序执行
2. **不要偷工减料**：宁可多轮对话，不可降低质量
3. **不要压缩内容**：宁可分批处理，不可省略细节
4. **不要跳过资源**：所有必读资源都必须完整读取
5. **不要忽略验证**：步骤4的验收是关键，必须严格执行

---

## 🔧 故障排除

### 问题诊断流程

```
遇到问题？
  ↓
检查错误类型
  ↓
查看对应解决方案
  ↓
尝试修复
  ↓
重新执行
  ↓
问题解决？
  ├─ 是 → 完成
  └─ 否 → 联系支持
```

### 常见问题与解决方案

#### 问题1：步骤1无法读取完整文档

**症状**：
- 提示"无法读取文档"
- 提示"文档格式不支持"
- 提示"文档内容为空"

**可能原因**：
- 文档路径错误
- 文档格式不支持
- 文档权限问题
- 文档内容为空

**解决方案**：
1. 检查文档路径是否正确（使用绝对路径或相对路径）
2. 确认文档格式是否支持（.md, .txt, .json, .html）
3. 检查文档权限（确保可读）
4. 确认文档内容不为空
5. 使用"继续"机制分批读取（如果文档过长）

#### 问题2：步骤2图表选择错误

**症状**：
- 提示"图表选择错误"
- 提示"内容被压缩或省略"
- 提示"分页不合理"

**可能原因**：
- 未正确读取图表选择指南
- 页面内容过多未分页
- 图表类型与数据不匹配

**解决方案**：
1. 返回步骤2重新执行
2. 仔细阅读 `chart-selection-guide.md`
3. 根据决策树重新选择图表
4. 确保每页内容不超过8个要点
5. 验证数据点与图表类型匹配

#### 问题3：步骤3HTML生成不完整

**症状**：
- 提示"HTML生成不完整"
- 提示"资源未读取"
- 提示"设计规范不符合"

**可能原因**：
- 未正确读取必读资源
- 使用了非McKinsey风格元素
- 代码生成被token限制中断

**解决方案**：
1. 返回步骤3重新执行
2. 确保所有必读资源都已读取（best-practices.md、mckinsey-design-system.md等）
3. 检查是否使用了紫色渐变、圆角卡片等非McKinsey元素
4. 使用"继续"机制分批生成（如果代码过长）
5. 验证颜色、字体、布局符合McKinsey标准

#### 问题4：步骤4验证不通过

**症状**：
- 提示"验证不通过"
- 提示"存在设计规范违规"
- 提示"存在内容遗漏"

**可能原因**：
- 设计规范不符合
- 内容被压缩或省略
- 代码存在错误

**解决方案**：
1. 查看详细的验证报告
2. 根据报告返回对应步骤
3. 修复具体问题（颜色、字体、布局、内容等）
4. 重新执行验证
5. 确保所有验证项目都通过

#### 问题5：生成的HTML文件无法打开

**症状**：
- 浏览器无法打开HTML文件
- 显示乱码
- 图表不显示

**可能原因**：
- 文件编码问题
- Chart.js CDN无法访问
- 浏览器兼容性问题

**解决方案**：
1. 确认文件编码为UTF-8
2. 检查网络连接（Chart.js CDN需要网络）
3. 尝试不同浏览器（Chrome、Firefox、Safari、Edge）
4. 检查浏览器控制台错误（F12）
5. 确认JavaScript已启用

#### 问题6：响应式设计不正常

**症状**：
- 在手机上显示混乱
- 在平板上布局错位
- 图表在小屏幕上不显示

**可能原因**：
- 响应式断点设置不当
- CSS媒体查询缺失
- 图表容器高度固定

**解决方案**：
1. 检查CSS中的媒体查询
2. 确认图表容器使用相对高度
3. 测试不同屏幕尺寸（320px、768px、1024px、1440px）
4. 验证flex和grid布局正确
5. 确保所有元素都有max-width限制

### 获取帮助

如果以上解决方案都无法解决问题：

1. **查看详细日志**：检查每个步骤的输出日志
2. **验证资源文件**：确认所有必读资源都存在且可读
3. **检查文档格式**：确认源文档格式正确
4. **联系支持**：提供详细的错误信息和执行日志

### 日志级别

```
INFO：正常执行信息
WARN：警告信息（不影响执行）
ERROR：错误信息（需要修复）
FATAL：致命错误（执行失败）
```

---

## 📚 相关资源

### Skill文档
- `.trae/skills/beauty-step1/SKILL.md` - 步骤1：文档内容分析合并
- `.trae/skills/beauty-step2/SKILL.md` - 步骤2：幻灯片内容转换与拆分
- `.trae/skills/beauty-step3/SKILL.md` - 步骤3：HTML样式布局代码规划与生成
- `.trae/skills/beauty-step4/SKILL.md` - 步骤4：代码内容审核检验

### 参考资源
- `beauty-html/references/chart-selection-guide.md` - 图表选择指南
- `beauty-html/references/best-practices.md` - HTML最佳实践
- `beauty-html/references/mckinsey-design-system.md` - McKinsey设计系统
- `beauty-html/assets/presentation-template.html` - 演示文稿模板
- `beauty-html/assets/TEMPLATE_USAGE_GUIDE.md` - 模板使用指南
- `beauty-html/assets/CHART_EXAMPLES_INDEX.md` - 图表示例索引
- `beauty-html/assets/INSIGHT_VISUALIZATION_GUIDE.md` - 观点可视化指南
- `beauty-html/assets/INDEX.md` - 布局和图表示例索引（全局）
- `.ppt_assets/INDEX.md` - 项目特定资源索引（如果存在，优先级最高）

---

## 📝 命令最佳实践

### 执行原则

**1. 质量优先**
- 宁可多轮对话，不可降低质量
- 宁可分批处理，不可压缩内容
- 宁可触发继续，不可偷工减料

**2. 完整性保证**
- 100%保留原文所有内容
- 零遗漏、零压缩、零简化
- 所有章节、数据、结论都必须包含

**3. 标准强制执行**
- 严格遵循McKinsey设计规范
- 颜色、字体、布局必须符合标准
- 禁止使用非McKinsey风格元素

**4. 资源必须读取**
- 所有必读资源都必须完整读取
- 优先使用项目特定资源（.ppt_assets/INDEX.md）
- 确保资源使用验证通过

**5. 错误立即回退**
- 发现问题立即返回对应步骤
- 不将就，不继续执行
- 确保所有验证都通过

### 性能优化

**1. Token管理**
- 遇到token限制时使用"继续"机制
- 分批读取大文档
- 分批生成HTML代码

**2. 执行效率**
- 自动化执行4个步骤
- 无需手动干预
- 自动验证和回退

**3. 质量保证**
- 每步都有验证标准
- 实行一票否决制
- 确保输出质量

### 输出规范

**1. 文件命名**
- 使用清晰的文件名：`[文档标题]_McKinsey风格演示文稿.html`
- 避免特殊字符
- 使用UTF-8编码

**2. 文件格式**
- 标准HTML5格式
- 包含完整的DOCTYPE声明
- 正确闭合所有标签

**3. 依赖管理**
- 唯一外部依赖：Chart.js CDN
- 使用稳定版本（4.4.0）
- 提供CDN备用方案

**4. 验收报告**
- 包含所有验证项目
- 提供详细的问题描述
- 给出明确的修复建议

---

## 🎯 命令总结

### 核心价值

**Beauty命令的核心价值**：
- ✅ **自动化**：自动执行4步流程，无需手动干预
- ✅ **质量保证**：严格的验证标准和回退机制
- ✅ **标准遵循**：100%符合McKinsey设计规范
- ✅ **内容完整**：100%保留原文所有内容
- ✅ **错误恢复**：自动回退和修复机制

### 适用场景

**最适合的场景**：
- 需要将文档转换为演示文稿
- 要求专业、简洁的设计风格
- 需要数据可视化和图表
- 需要符合McKinsey/BCG标准

**不适合的场景**：
- 需要高度自定义的动画效果
- 需要复杂的交互功能
- 需要非McKinsey风格的设计

### 成功指标

**执行成功的标志**：
- 所有4个步骤都已完成
- 所有验证项目都通过
- HTML文件可以正常运行
- 符合McKinsey设计标准
- 内容100%保留

**质量评分标准**：
- A+：优秀（所有验证都通过，无任何问题）
- A：良好（所有验证都通过，有少量警告）
- B：合格（所有验证都通过，有一些问题）
- C：不合格（存在严重问题，需要修复）
- D：失败（存在致命错误，需要重新执行）

---

**Beauty命令已准备就绪！**

**使用方法**：`/beauty [文档路径]`

**示例**：`/beauty ./my-document.md`

**支持格式**：.md, .txt, .json, .html

**输出**：McKinsey风格HTML演示文稿 + 验收报告
