# HTML Presentation Beautifier - 流程总结

**版本**: v2.2.0 | **更新日期**: 2025-01-25

---

## 🎯 核心功能

将文档转化为**专业 McKinsey 风格 HTML 演示文稿**，100%保留内容，仅进行展示性美化。

---

## 📊 完整工作流程（6阶段）

```
┌─────────────────────────────────────────────────────────────────┐
│                    用户触发 /beauty 命令                        │
└──────────────────────────┬──────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────────┐
│  Phase 1: 文档解析 (Parse Document)                           │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │ 1. 文件验证（存在性、可读性、格式识别）                     │  │
│  │ 2. 结构提取（标题层级、列表、数据表格、结论）                │  │
│  │ 3. 数据识别（数值型、百分比、时间序列）                     │  │
│  │ 4. 内容映射（主要章节 → 幻灯片分区）                       │  │
│  └────────────────────────────────────────────────────────────┘  │
│  输出: 结构化内容树                                              │
└──────────────────────────┬──────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────────┐
│  Phase 2: 内容规划 (Plan Slides)                              │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │ AI Subagent: general-purpose                               │  │
│  │                                                             │  │
│  │ 1. 幻灯片类型分配:                                          │  │
│  │    - TITLE, TOC, DATA_VISUALIZATION, CONCEPTUAL, CONTENT    │  │
│  │    - CONCLUSIONS, INSIGHTS                                  │  │
│  │                                                             │  │
│  │ 2. 可视化分配:                                             │  │
│  │    - Chart.js 类型: bar, line, pie, doughnut, radar...      │  │
│  │    - 概念图表类型: progression, timeline, flowchart...      │  │
│  │                                                             │  │
│  │ 3. 布局分配:                                               │  │
│  │    - two-column, full-width, conclusions-grid, etc.        │  │
│  │                                                             │  │
│  │ 4. CRITICAL: 100% 内容保留                                  │  │
│  │    - 精确数据精度（1723.498, 365.875）                     │  │
│  │    - 原文措辞保留（无改写）                                  │  │
│  │    - 创建足够幻灯片容纳所有内容                            │  │
│  └────────────────────────────────────────────────────────────┘  │
│  输出: JSON 幻灯片计划                                           │
└──────────────────────────┬──────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────────┐
│  Phase 3: 设计应用 (Apply Design)                              │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │ 1. 布局选择: title-center, two-column, chart-focused...      │  │
│  │                                                             │  │
│  │ 2. 应用颜色系统:                                           │  │
│  │    - 背景: #FFFFFF                                        │  │
│  │    - 标题: #000000                                        │  │
│  │    - 强调色: #F85d42                                       │  │
│  │    - 辅助色: #556EE6, #34c38f, #50a5f1, #f1b44c            │  │
│  │                                                             │  │
│  │ 3. 设置字体层级:                                            │  │
│  │    - 标题: 48-64px Bold                                   │  │
│  │    - 副标题: 28-36px Bold                                 │  │
│  │    - 正文: 16-20px Regular                               │  │
│  │                                                             │  │
│  │ 4. 优化间距和布局:                                          │  │
│  │    - 边距: 40-60px                                        │  │
│  │    - 间距: 20-30px                                        │  │
│  │                                                             │  │
│  │ 5. 设计图表风格: 清晰、极简、专业                          │  │
│  └────────────────────────────────────────────────────────────┘  │
│  输出: 应用 McKinsey 风格的内容结构                             │
└──────────────────────────┬──────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────────┐
│  Phase 3.5: 可视化美化 (Content Visualization) ← 新增           │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │ AI Subagent: general-purpose                               │  │
│  │                                                             │  │
│  │ 1. 内容结构分析（9种观点类型识别）:                         │  │
│  │    - 递进型 → progression, timeline, flowchart              │  │
│  │    - 时间序列型 → timeline, strategy-roadmap, line-chart   │  │
│  │    - 并列型 → emphasis-box, mindmap, matrix                │  │
│  │    - 层级型 → pyramid, inverted-pyramid, tree              │  │
│  │    - 对比型 → comparison, pros-cons, venn-diagram          │  │
│  │    - 分析框架型 → swot, ansoff, competitive-4box          │  │
│  │    - 转化流程型 → funnel, value-stream                    │  │
│  │    - 循环型 → cycle, circular-flow                         │  │
│  │    - 因果型 → problem-solution, pareto, gauge              │  │
│  │                                                             │  │
│  │ 2. 可视化方式分配（引用 assets/ 库）:                      │  │
│  │    - 23个示例文件                                          │  │
│  │    - McKinsey 预配置                                       │  │
│  │    - 即插即用                                              │  │
│  │                                                             │  │
│  │ 3. CRITICAL: 禁止纯文字列表                                │  │
│  │    - 所有结论必须使用可视化                                │  │
│  │    - 根据内容结构选择合适图表                              │  │
│  └────────────────────────────────────────────────────────────┘  │
│  输出: 增强的幻灯片计划（含可视化类型）                         │
└──────────────────────────┬──────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────────┐
│  Phase 4: HTML生成 (Generate HTML) - 优化 4 步流程            │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │ AI Subagent: general-purpose                               │  │
│  │                                                             │  │
│  │ Step 4.1: 模板选择                                          │  │
│  │    - 幻灯片#1 → cover-slide-template.html                  │  │
│  │    - 幻灯片#2 → toc-slide-template.html                    │  │
│  │    - 幻灯片#3-N-1 → content-slide-template.html            │  │
│  │    - 幻灯片#N → end-slide-template.html                    │  │
│  │                                                             │  │
│  │ Step 4.2: 内容分析与图表/图文选择                            │  │
│  │    - 数据型幻灯片 → Chart.js 图表（8种）                    │  │
│  │    - 概念型幻灯片 → CSS 概念图表（23种）                    │  │
│  │    - 9种观点类型识别与匹配                                  │  │
│  │    - 禁止纯文本列表展示结论                                  │  │
│  │                                                             │  │
│  │ Step 4.3: 应用优化                                          │  │
│  │    - 集成模板结构与内容                                     │  │
│  │    - 使用精确文本（1723.498, 365.875）                     │  │
│  │    - 应用 McKinsey 设计系统                                 │  │
│  │    - 初始化所有图表                                         │  │
│  │                                                             │  │
│  │ Step 4.4: HTML 文件输出                                     │  │
│  │    - 单文件、自包含                                         │  │
│  │    - 所有 CSS/JavaScript 内联                               │  │
│  │    - 仅依赖 Chart.js CDN                                    │  │
│  └────────────────────────────────────────────────────────────┘  │
│  输出: {filename}_beautified.html                               │
│       - 完整 HTML 演示文稿                                       │
│       - 自包含、可直接使用                                      │
└──────────────────────────┬──────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────────┐
│  Phase 5: 审核验证 (Review & Verify)                           │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │ Agent: html-presentation-reviewer                           │  │
│  │                                                             │  │
│  │ 1. 内容完整性审核（CRITICAL）:                              │  │
│  │    ✅ 所有章节存在                                           │  │
│  │    ✅ 所有数据点可视化                                       │  │
│  │    ✅ 所有结论展示                                           │  │
│  │    ✅ 精确原文措辞                                           │  │
│  │    ✅ 列表项数量匹配                                         │  │
│  │                                                             │  │
│  │ 2. 模板使用审核:                                            │  │
│  │    ✅ 正确使用4种模板                                         │  │
│  │    ✅ 所有幻灯片存在                                         │  │
│  │    ✅ 幻灯片数量正确                                         │  │
│  │                                                             │  │
│  │ 3. McKinsey 风格合规性审核:                                 │  │
│  │    ✅ 颜色精确匹配（#F85d42, #556EE6等）                     │  │
│  │    ✅ 字体大小在范围内（48-64px, 28-36px, 16-20px）          │  │
│  │    ✅ 布局标准统一（40-60px, 20-30px）                      │  │
│  │                                                             │  │
│  │ 4. 代码质量审核:                                            │  │
│  │    ✅ HTML 结构有效                                          │  │
│  │    ✅ CSS 语法正确                                           │  │
│  │    ✅ JavaScript 函数完整                                    │  │
│  │                                                             │  │
│  │ 5. 交互性审核:                                              │  │
│  │    ✅ 导航按钮工作                                           │  │
│  │    ✅ 键盘快捷键功能                                         │  │
│  │    ✅ 全屏模式可操作                                         │  │
│  │    ✅ 图表工具提示激活                                       │  │
│  │                                                             │  │
│  │ 6. 图表有效性审核:                                          │  │
│  │    ✅ 图表类型匹配数据                                       │  │
│  │    ✅ 数据可视化准确                                         │  │
│  │    ✅ McKinsey 颜色应用                                     │  │
│  └────────────────────────────────────────────────────────────┘  │
│  输出: JSON 审核报告                                            │
│       - 总体评分（0-100）                                       │
│       - 分维度评分                                             │
│       - 问题列表（CRITICAL, MAJOR, MINOR）                     │
│       - 批准状态（APPROVED, NEEDS_REVISION, REJECTED）        │
│                                                             │
│  评分标准:                                                    │
│  ✅ 95-100: EXCELLENT - 可交付                                │
│  ✅ 85-94:  GOOD - 可接受，可选改进                            │
│  ⚠️ 75-84: ACCEPTABLE - 需要改进                              │
│  ❌ <75: REJECTED - 需要重新生成                              │
└─────────────────────────────────────────────────────────────────┘
                           ↓
┌─────────────────────────────────────────────────────────────────┐
│                    📄 输出专业演示文稿                        │
│                                                              │
│  • 文件: {original}_beautified.html                            │
│  • 大小: ~45KB（单文件，自包含）                               │
│  • 内容: 所有幻灯片 + 交互功能                               │
│  • 设计: McKinsey 风格                                        │
│  • 可直接在浏览器中打开                                      │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🎨 模板系统速查

| 模板 | 文件 | 使用 | 幻灯片# |
|------|------|------|---------|
| **封面页** | `cover-slide-template.html` | 演示开场 | 1 |
| **目录页** | `toc-slide-template.html` | 章节导航 | 2 |
| **内容页** | `content-slide-template.html` | 主要内容 | 3-N-1 |
| **结束页** | `end-slide-template.html` | 感谢结尾 | N |

**组件库**: 20+ 组件（标题、列表、图表、强调框、流程图、表格等）

---

## 📊 可视化库速查

**9种观点类型 × 23种图表示例**

| 观点类型 | 关键词 | 可视化 | 示例文件 |
|---------|--------|--------|----------|
| 递进型 | 首先、其次、步骤 | progression, flowchart | `flowchart-example.html` |
| 时间序列型 | 年份、季度、趋势 | timeline, roadmap | `timeline-example.html` |
| 并列型 | 同时、包括、另外 | emphasis-box, mindmap | `mindmap-example.html` |
| 层级型 | 基础、高级、核心 | pyramid, inverted-pyramid | `pyramid-chart-example.html` |
| 对比型 | 对比、差异、vs | comparison, pros-cons, venn | `venn-diagram-example.html` |
| 分析框架型 | SWOT, PEST, 5W1H | swot, ansoff, matrix | `swot-analysis-example.html` |
| 转化流程型 | 转化、漏斗、筛选 | funnel, value-stream | `funnel-chart-example.html` |
| 循环型 | 循环、迭代、反馈 | cycle, circular-flow | `polar-chart-example.html` |
| 因果型 | 原因、结果、问题 | problem-solution, pareto | `problem-solution-example.html` |

**Chart.js 图表**: bar, line, pie, doughnut, radar, polarArea, bubble, scatter

---

## ✅ 质量保证

### 内容完整性

- ✅ **100% 保留**: 所有章节、数据、结论
- ✅ **精确精度**: 1723.498, 365.875（不四舍五入）
- ✅ **原文措辞**: 精确保留，无改写
- ✅ **列表匹配**: 数量完全对应

### McKinsey 设计

- ✅ **精确颜色**: #F85d42, #556EE6, #34c38f 等
- ✅ **标准字体**: 48-64px, 28-36px, 16-20px
- ✅ **统一布局**: 40-60px 边距, 20-30px 间距

### 代码质量

- ✅ **有效 HTML**: W3C 标准
- ✅ **有效 CSS**: 无语法错误
- ✅ **完整 JavaScript**: 所有函数完整
- ✅ **交互功能**: 导航、键盘、全屏

---

## 🚀 使用方法

```bash
# 基础使用
/beauty document.md

# 多文件
/beauty report.md analysis.md data.json

# 输出示例
report.md → report_beautified.html
analysis.json → analysis_beautified.html
```

---

## 📈 性能指标

- **开发速度**: 77-84% 快于手动生成
- **设计质量**: 100% McKinsey 合规
- **内容准确性**: 100% 数据精度
- **生产就绪**: ✅ 是

---

## 📚 关键文档

| 文档 | 内容 |
|------|------|
| `COMPLETE_WORKFLOW_GUIDE.md` | 本文档（完整流程） |
| `SKILL.md` | 主技能文档（6阶段详情） |
| `SLIDE_TEMPLATES_GUIDE.md` | 模板使用指南 |
| `SLIDE_TEMPLATES_QUICK_REF.md` | 模板快速参考 |
| `CONTENT_VISUALIZATION_INTEGRATION.md` | 可视化集成说明 |
| `assets/INSIGHT_VISUALIZATION_GUIDE.md` | 观点可视化指南 |
| `assets/CHART_EXAMPLES_INDEX.md` | 图表示例索引 |

---

**版本**: v2.2.0
**状态**: ✅ 生产就绪
**维护者**: within7 (wxj@within-7.com)
**最后更新**: 2025-01-25
